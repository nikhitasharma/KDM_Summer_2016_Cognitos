no-1:DT title-2:NN Spark-1:VB :-2:: Cluster-3:NNP Computing-4:NNP with-5:IN Working-6:VBG Sets-7:NNS Matei-1:NNP Zaharia-2:NNP ,-3:, Mosharaf-4:NNP Chowdhury-5:NNP ,-6:, Michael-7:NNP J.-8:NNP Franklin-9:NNP ,-10:, Scott-11:NNP Shenker-12:NNP ,-13:, Ion-14:NNP Stoica-15:NNP University-16:NNP of-17:IN California-18:NNP ,-19:, Berkeley-20:NNP Abstract-1:JJ MapReduce-2:NN and-3:CC its-4:PRP$ variants-5:NNS have-6:VBP been-7:VBN highly-8:RB successful-9:JJ in-10:IN implementing-11:VBG large-scale-12:JJ data-intensive-13:JJ applications-14:NNS on-15:IN commodity-16:NN clusters-17:NNS .-18:. However-1:RB ,-2:, most-3:JJS of-4:IN these-5:DT systems-6:NNS are-7:VBP built-8:VBN around-9:IN an-10:DT acyclic-11:JJ data-12:NN flow-13:NN model-14:NN that-15:WDT is-16:VBZ not-17:RB suitable-18:JJ for-19:IN other-20:JJ popular-21:JJ applications-22:NNS .-23:. This-1:DT paper-2:NN focuses-3:VBZ on-4:IN one-5:CD such-6:JJ class-7:NN of-8:IN applications-9:NNS :-10:: those-11:DT that-12:WDT reuse-13:VBP a-14:DT working-15:VBG set-16:NN of-17:IN data-18:NNS across-19:IN multiple-20:JJ parallel-21:JJ operations-22:NNS .-23:. This-1:DT includes-2:VBZ many-3:JJ iterative-4:JJ machine-5:NN learning-6:VBG algorithms-7:NNS ,-8:, as-9:RB well-10:RB as-11:IN interactive-12:JJ data-13:NN analysis-14:NN tools-15:NNS .-16:. We-1:PRP propose-2:VBP a-3:DT new-4:JJ framework-5:NN called-6:VBN Spark-7:NNP that-8:WDT supports-9:VBZ these-10:DT applications-11:NNS while-12:IN retaining-13:VBG the-14:DT scalability-15:NN and-16:CC fault-17:NN tolerance-18:NN of-19:IN MapReduce-20:NNP .-21:. To-1:TO achieve-2:VB these-3:DT goals-4:NNS ,-5:, Spark-6:NN introduces-7:VBZ an-8:DT abstraction-9:NN called-10:VBN resilient-11:JJ distributed-12:VBN datasets-13:NNS -LRB--14:-LRB- RDDs-15:NNS -RRB--16:-RRB- .-17:. An-1:DT RDD-2:NN is-3:VBZ a-4:DT read-only-5:JJ collection-6:NN of-7:IN objects-8:NNS partitioned-9:VBN across-10:IN a-11:DT set-12:NN of-13:IN machines-14:NNS that-15:WDT can-16:MD be-17:VB rebuilt-18:VBN if-19:IN a-20:DT partition-21:NN is-22:VBZ lost-23:VBN .-24:. Spark-1:NN can-2:MD outperform-3:VB Hadoop-4:NN by-5:IN 10x-6:NN in-7:IN iterative-8:JJ machine-9:NN learning-10:VBG jobs-11:NNS ,-12:, and-13:CC can-14:MD be-15:VB used-16:VBN to-17:TO interactively-18:RB query-19:VB a-20:DT 39-21:CD GB-22:NN dataset-23:NN with-24:IN sub-second-25:JJ response-26:NN time-27:NN .-28:. 1-1:CD Introduction-2:NN A-3:DT new-4:JJ model-5:NN of-6:IN cluster-7:NN computing-8:NN has-9:VBZ become-10:VBN widely-11:RB popular-12:JJ ,-13:, in-14:IN which-15:WDT data-parallel-16:JJ computations-17:NNS are-18:VBP executed-19:VBN on-20:IN clusters-21:NNS of-22:IN unreliable-23:JJ machines-24:NNS by-25:IN systems-26:NNS that-27:WDT automatically-28:RB provide-29:VBP locality-aware-30:JJ scheduling-31:NN ,-32:, fault-33:NN tolerance-34:NN ,-35:, and-36:CC load-37:NN balancing-38:NN .-39:. MapReduce-1:NN -LSB--2:-LRB- 11-3:CD -RSB--4:-RRB- pioneered-5:VBD this-6:DT model-7:NN ,-8:, while-9:IN systems-10:NNS like-11:IN Dryad-12:NNP -LSB--13:-LRB- 17-14:CD -RSB--15:-RRB- and-16:CC Map-Reduce-Merge-17:JJ -LSB--18:-LRB- 24-19:CD -RSB--20:-RRB- generalized-21:VBN the-22:DT types-23:NNS of-24:IN data-25:NNS flows-26:VBZ supported-27:VBN .-28:. These-1:DT systems-2:NNS achieve-3:VBP their-4:PRP$ scalability-5:NN and-6:CC fault-7:NN tolerance-8:NN by-9:IN providing-10:VBG a-11:DT programming-12:NN model-13:NN where-14:WRB the-15:DT user-16:NN creates-17:VBZ acyclic-18:JJ data-19:NNS flow-20:NN graphs-21:NNS to-22:TO pass-23:VB input-24:NN data-25:NNS through-26:IN a-27:DT set-28:NN of-29:IN operators-30:NNS .-31:. This-1:DT allows-2:VBZ the-3:DT underlying-4:JJ system-5:NN to-6:TO manage-7:VB scheduling-8:NN and-9:CC to-10:TO react-11:VB to-12:TO faults-13:NNS without-14:IN user-15:NN intervention-16:NN .-17:. While-1:IN this-2:DT data-3:NN flow-4:NN programming-5:NN model-6:NN is-7:VBZ useful-8:JJ for-9:IN a-10:DT large-1:JJ class-2:NN of-3:IN applications-4:NNS ,-5:, there-6:EX are-7:VBP applications-8:NNS that-9:WDT can-10:MD not-11:RB be-12:VB expressed-13:VBN efficiently-14:RB as-15:IN acyclic-16:JJ data-17:NNS flows-18:NNS .-19:. In-1:IN this-2:DT paper-3:NN ,-4:, we-5:PRP focus-6:VBP on-7:IN one-8:CD such-9:JJ class-10:NN of-11:IN applications-12:NNS :-13:: those-14:DT that-15:WDT reuse-16:VBP a-17:DT working-18:VBG set-19:NN of-20:IN data-21:NNS across-22:IN multiple-23:JJ parallel-24:JJ operations-25:NNS .-26:. This-1:DT includes-2:VBZ two-3:CD use-4:NN cases-5:NNS where-6:WRB we-7:PRP have-8:VBP seen-9:VBN Hadoop-10:NNP users-11:NNS report-12:VBP that-13:IN MapReduce-14:NNP is-15:VBZ deficient-16:JJ :-17:: •-1:NN Iterative-2:JJ jobs-3:NNS :-4:: Many-5:JJ commonmachine-6:JJ learning-7:NN algorithms-8:NNS apply-9:VBP a-10:DT function-11:NN repeatedly-12:RB to-13:TO the-14:DT same-15:JJ dataset-16:NN to-17:TO optimize-18:VB a-19:DT parameter-20:NN -LRB--21:-LRB- e.g.-22:FW ,-23:, through-24:IN gradient-25:NN descent-26:NN -RRB--27:-RRB- .-28:. While-1:IN each-2:DT iteration-3:NN can-4:MD be-5:VB expressed-6:VBN as-7:IN a-8:DT MapReduce/Dryad-1:NNP job-2:NN ,-3:, each-4:DT job-5:NN must-6:MD reload-7:VB the-8:DT data-9:NNS from-10:IN disk-11:NN ,-12:, incurring-13:VBG a-14:DT significant-15:JJ performance-16:NN penalty-17:NN .-18:. •-1:NN Interactive-2:JJ analytics-3:NNS :-4:: Hadoop-5:NNP is-6:VBZ often-7:RB used-8:VBN to-9:TO run-10:VB ad-hoc-11:JJ exploratory-12:JJ queries-13:NNS on-14:IN large-15:JJ datasets-16:NNS ,-17:, through-18:IN SQL-19:NNP interfaces-20:NNS such-21:JJ as-22:IN Pig-23:NN -LSB--24:-LRB- 21-25:CD -RSB--26:-RRB- and-27:CC Hive-28:NNP -LSB--29:-LRB- 1-30:CD -RSB--31:-RRB- .-32:. Ideally-1:RB ,-2:, a-3:DT user-4:NN would-5:MD be-6:VB able-7:JJ to-8:TO load-9:VB a-10:DT dataset-11:NN of-12:IN interest-13:NN into-14:IN memory-15:NN across-16:IN a-17:DT number-18:NN of-19:IN machines-20:NNS and-21:CC query-22:VB it-23:PRP repeatedly-24:RB .-25:. However-1:RB ,-2:, with-3:IN Hadoop-4:NNP ,-5:, each-6:DT query-7:NN incurs-8:VBZ significant-9:JJ latency-10:NN -LRB--11:-LRB- tens-12:NNS of-13:IN seconds-14:NNS -RRB--15:-RRB- because-16:IN it-17:PRP runs-18:VBZ as-19:IN a-20:DT separate-21:JJ MapReduce-22:NNP job-23:NN and-24:CC reads-25:VBZ data-26:NNS from-27:IN disk-28:NN .-29:. This-1:DT paper-2:NN presents-3:VBZ a-4:DT new-5:JJ cluster-6:NN computing-7:NN framework-8:NN called-9:VBN Spark-10:NNP ,-11:, which-12:WDT supports-13:VBZ applications-14:NNS with-15:IN working-16:VBG sets-17:NNS while-18:IN providing-19:VBG similar-20:JJ scalability-21:NN and-22:CC fault-23:NN tolerance-24:NN properties-25:NNS to-26:TO MapReduce-27:NNP .-28:. The-1:DT main-2:JJ abstraction-3:NN in-4:IN Spark-5:NNP is-6:VBZ that-7:DT of-8:IN a-9:DT resilient-10:JJ dis-11:NN --12:: tributed-1:VBN dataset-2:NN -LRB--3:-LRB- RDD-4:NN -RRB--5:-RRB- ,-6:, which-7:WDT represents-8:VBZ a-9:DT read-only-10:JJ collection-11:NN of-12:IN objects-13:NNS partitioned-14:VBN across-15:IN a-16:DT set-17:NN of-18:IN machines-19:NNS that-20:WDT can-21:MD be-22:VB rebuilt-23:VBN if-24:IN a-25:DT partition-26:NN is-27:VBZ lost-28:VBN .-29:. Users-1:NNS can-2:MD explicitly-3:RB cache-4:NN an-5:DT RDD-6:NN in-7:IN memory-8:NN across-9:IN machines-10:NNS and-11:CC reuse-12:VB it-13:PRP in-14:IN multiple-15:JJ MapReduce-like-16:JJ parallel-17:NN operations-18:NNS .-19:. RDDs-1:NNS achieve-2:VBP fault-3:NN tolerance-4:NN through-5:IN a-6:DT notion-7:NN of-8:IN lineage-9:NN :-10:: if-11:IN a-12:DT partition-13:NN of-14:IN an-15:DT RDD-16:NN is-17:VBZ lost-18:VBN ,-19:, the-20:DT RDD-21:NNP has-22:VBZ enough-23:JJ information-24:NN about-25:IN how-26:WRB it-27:PRP was-28:VBD derived-29:VBN from-30:IN other-31:JJ RDDs-32:NNS to-33:TO be-34:VB able-35:JJ to-36:TO rebuild-37:VB just-38:RB that-39:DT partition-40:NN .-41:. Although-1:IN RDDs-2:NNS are-3:VBP not-4:RB a-5:DT general-6:JJ shared-7:JJ memory-8:NN abstraction-9:NN ,-10:, they-11:PRP represent-12:VBP a-13:DT sweet-spot-14:NN between-15:IN expressivity-16:NN on-17:IN the-18:DT one-19:CD hand-20:NN and-21:CC scalability-22:NN and-23:CC reliability-24:NN on-25:IN the-26:DT other-27:JJ hand-28:NN ,-29:, and-30:CC we-31:PRP have-32:VBP found-33:VBN them-34:PRP well-suited-35:JJ for-36:IN a-37:DT variety-38:NN of-39:IN applications-40:NNS .-41:. Spark-1:NN is-2:VBZ implemented-3:VBN in-4:IN Scala-5:NNP -LSB--6:-LRB- 5-7:CD -RSB--8:-RRB- ,-9:, a-10:DT statically-11:RB typed-12:VBN high-level-1:JJ programming-2:NN language-3:NN for-4:IN the-5:DT Java-6:NNP VM-7:NNP ,-8:, and-9:CC exposes-10:VBZ a-11:DT functional-12:JJ programming-13:NN interface-14:NN similar-15:JJ to-16:TO DryadLINQ-17:NN -LSB--18:-LRB- 25-19:CD -RSB--20:-RRB- .-21:. In-1:IN addition-2:NN ,-3:, Spark-4:NN can-5:MD be-6:VB used-7:VBN interactively-8:RB from-9:IN a-10:DT modified-11:VBN version-12:NN of-13:IN the-14:DT Scala-15:NNP interpreter-16:NN ,-17:, which-18:WDT allows-19:VBZ the-20:DT user-21:NN to-22:TO define-23:VB RDDs-24:NNS ,-25:, functions-26:NNS ,-27:, variables-28:NNS and-29:CC classes-30:NNS and-31:CC use-32:VB them-33:PRP in-34:IN parallel-35:JJ operations-36:NNS on-37:IN a-38:DT cluster-39:NN .-40:. We-1:PRP believe-2:VBP that-3:IN Spark-4:NN is-5:VBZ the-6:DT first-7:JJ system-8:NN to-9:TO allow-10:VB an-11:DT efficient-12:JJ ,-13:, general-purpose-14:JJ programming-15:NN language-16:NN to-17:TO be-18:VB used-19:VBN interactively-20:RB to-21:TO process-22:VB large-23:JJ datasets-24:NNS on-25:IN a-26:DT cluster-27:NN .-28:. Although-1:IN our-2:PRP$ implementation-3:NN of-4:IN Spark-5:NNP is-6:VBZ still-7:RB a-8:DT proto-9:NN --10:: type-1:NN ,-2:, early-3:JJ experience-4:NN with-5:IN the-6:DT system-7:NN is-8:VBZ encouraging-9:VBG .-10:. We-1:PRP show-2:VBP that-3:IN Spark-4:NN can-5:MD outperform-6:VB Hadoop-7:NN by-8:IN 10x-9:NN in-10:IN iterative-11:JJ machine-12:NN learning-13:VBG workloads-14:NNS and-15:CC can-16:MD be-17:VB used-18:VBN interactively-19:RB to-20:TO scan-21:VB a-22:DT 39-23:CD GB-24:NN dataset-25:NN with-26:IN sub-second-27:JJ latency-28:NN .-29:. This-1:DT paper-2:NN is-3:VBZ organized-4:VBN as-5:IN follows-6:VBZ .-7:. Section-1:NN 2-2:CD describes-3:VBZ Spark-1:NN 's-2:POS programming-3:NN model-4:NN and-5:CC RDDs-6:NNS .-7:. Section-1:NN 3-2:CD shows-3:VBZ some-4:DT example-5:NN jobs-6:NNS .-7:. Section-1:NN 4-2:CD describes-3:VBZ our-4:PRP$ implementation-5:NN ,-6:, including-7:VBG our-8:PRP$ integration-9:NN into-10:IN Scala-11:NNP and-12:CC its-13:PRP$ interpreter-14:NN .-15:. Section-1:NN 5-2:CD presents-3:VBZ early-4:JJ results-5:NNS .-6:. We-1:PRP survey-2:VBP related-3:JJ work-4:NN in-5:IN Section-6:NN 6-7:CD and-8:CC end-9:VB with-10:IN a-11:DT discussion-12:NN in-13:IN Section-14:NN 7-15:CD .-16:. 2-1:CD Programming-2:NNP Model-3:NNP To-4:TO use-5:VB Spark-6:NNP ,-7:, developers-8:NNS write-9:VBP a-10:DT driver-11:NN program-12:NN that-13:WDT implements-14:VBZ the-15:DT high-level-16:JJ control-17:NN flow-18:NN of-19:IN their-20:PRP$ application-21:NN and-22:CC launches-23:NNS various-24:JJ operations-25:NNS in-26:IN parallel-27:NN .-28:. Spark-1:NN provides-2:VBZ two-3:CD main-4:JJ abstractions-5:NNS for-6:IN parallel-7:JJ programming-8:NN :-9:: resilient-10:JJ distributed-11:VBN datasets-12:NNS and-13:CC parallel-14:JJ operations-15:NNS on-16:IN these-17:DT datasets-18:NNS -LRB--19:-LRB- invoked-20:VBN by-21:IN passing-22:VBG a-23:DT function-24:NN to-25:TO apply-26:VB on-27:IN a-28:DT dataset-29:NN -RRB--30:-RRB- .-31:. In-1:IN addition-2:NN ,-3:, Spark-4:NN supports-5:VBZ two-6:CD restricted-7:JJ types-8:NNS of-9:IN shared-10:JJ variables-11:NNS that-12:WDT can-13:MD be-14:VB used-15:VBN in-16:IN functions-17:NNS running-18:VBG on-19:IN the-20:DT cluster-21:NN ,-22:, which-23:WDT we-24:PRP shall-25:MD explain-26:VB later-27:RB .-28:. 2.1-1:CD Resilient-2:NNP Distributed-3:VBN Datasets-4:NNS -LRB--5:-LRB- RDDs-6:NNS -RRB--7:-RRB- A-1:DT resilient-2:JJ distributed-3:VBN dataset-4:NN -LRB--5:-LRB- RDD-6:NN -RRB--7:-RRB- is-8:VBZ a-9:DT read-only-10:JJ collection-11:NN of-12:IN objects-13:NNS partitioned-14:VBN across-15:IN a-16:DT set-17:NN of-18:IN machines-19:NNS that-20:WDT can-21:MD be-22:VB rebuilt-23:VBN if-24:IN a-25:DT partition-26:NN is-27:VBZ lost-28:VBN .-29:. The-1:DT elements-2:NNS of-3:IN an-4:DT RDD-5:NN need-6:MD not-7:RB exist-8:VB in-9:IN physical-10:JJ storage-11:NN ;-12:: instead-13:RB ,-14:, a-15:DT handle-16:VB to-17:TO an-18:DT RDD-19:NN contains-20:VBZ enough-21:JJ information-22:NN to-23:TO compute-24:VB the-25:DT RDD-26:NN starting-27:VBG from-28:IN data-29:NNS in-30:IN reliable-31:JJ storage-32:NN .-33:. This-1:DT means-2:VBZ that-3:IN RDDs-4:NNS can-5:MD always-6:RB be-7:VB reconstructed-8:VBN if-9:IN nodes-10:NNS fail-11:VBP .-12:. In-1:IN Spark-2:NNP ,-3:, each-4:DT RDD-5:NN is-6:VBZ represented-7:VBN by-8:IN a-9:DT Scala-10:NNP object-11:NN .-12:. Spark-1:VB lets-2:VBZ programmers-3:NNS construct-4:NN RDDs-5:NNS in-6:IN four-7:CD ways-8:NNS :-9:: •-10:CD From-11:IN a-12:DT file-13:NN in-14:IN a-15:DT shared-16:JJ file-17:NN system-18:NN ,-19:, such-20:JJ as-21:IN the-22:DT Hadoop-23:NNP Distributed-24:VBD File-25:NNP System-26:NNP -LRB--27:-LRB- HDFS-28:NN -RRB--29:-RRB- .-30:. •-1:NN By-2:IN ``-3:`` parallelizing-4:JJ ''-5:'' a-6:DT Scala-7:NNP collection-8:NN -LRB--9:-LRB- e.g.-10:FW ,-11:, an-12:DT array-13:NN -RRB--14:-RRB- in-15:IN the-16:DT driver-17:NN program-18:NN ,-19:, which-20:WDT means-21:VBZ dividing-22:VBG it-23:PRP into-24:IN a-25:DT number-26:NN of-27:IN slices-28:NNS that-29:WDT will-30:MD be-31:VB sent-32:VBN to-33:TO multiple-34:JJ nodes-35:NNS .-36:. •-1:NN By-2:IN transforming-3:VBG an-4:DT existing-5:VBG RDD-6:NN .-7:. A-1:DT dataset-2:NN with-3:IN elements-4:NNS of-5:IN typeA-6:NN can-7:MD be-8:VB transformed-9:VBN into-10:IN a-11:DT dataset-12:NN with-13:IN elements-14:NNS of-15:IN type-16:NN B-17:NN using-18:VBG an-19:DT operation-20:NN called-21:VBN flatMap-22:NNP ,-23:, which-24:WDT passes-25:VBZ each-26:DT element-27:NN through-28:IN a-29:DT user-provided-30:JJ function-31:NN of-32:IN type-33:NN A-34:NN ⇒-35:CD List-36:NN -LSB--37:-LRB- B-38:NN -RSB--39:-RRB- .1-40:CD Other-41:JJ transformations-42:NNS can-43:MD be-44:VB expressed-45:VBN using-46:VBG flatMap-47:NN ,-48:, including-49:VBG map-50:NN -LRB--51:-LRB- pass-52:NN elements-53:NNS through-54:IN a-55:DT function-56:NN of-57:IN type-58:NN A-59:NN ⇒-60:NN B-61:NN -RRB--62:-RRB- and-63:CC filter-64:NN -LRB--65:-LRB- pick-66:NN elements-67:NNS matching-68:VBG a-69:DT predicate-70:NN -RRB--71:-RRB- .-72:. •-1:NN By-2:IN changing-3:VBG the-4:DT persistence-5:NN of-6:IN an-7:DT existing-8:VBG RDD-9:NN .-10:. By-1:IN default-2:NN ,-3:, RDDs-4:NNS are-5:VBP lazy-6:JJ and-7:CC ephemeral-8:JJ .-9:. That-1:DT is-2:VBZ ,-3:, partitions-4:NNS of-5:IN a-6:DT dataset-7:NN are-8:VBP materialized-9:VBN on-10:IN demand-11:NN when-12:WRB they-13:PRP are-14:VBP used-15:VBN in-16:IN a-17:DT parallel-18:JJ operation-19:NN -LRB--20:-LRB- e.g.-21:FW ,-22:, by-23:IN passing-24:VBG a-25:DT block-26:NN of-27:IN a-28:DT file-29:NN through-30:IN a-31:DT map-32:NN function-33:NN -RRB--34:-RRB- ,-35:, and-36:CC are-37:VBP discarded-38:VBN from-39:IN memory-40:NN after-41:IN use-42:NN .2-43:NN However-44:RB ,-45:, a-46:DT user-47:NN can-48:MD alter-49:VB the-50:DT persistence-51:NN of-52:IN an-53:DT RDD-54:NN through-55:IN two-56:CD actions-57:NNS :-58:: --59:: The-60:DT cache-61:NN action-62:NN leaves-63:VBZ the-64:DT dataset-65:NN lazy-66:JJ ,-67:, but-68:CC hints-69:NNS that-70:IN it-71:PRP should-72:MD be-73:VB kept-74:VBN in-75:IN memory-76:NN after-77:IN the-78:DT first-79:JJ time-80:NN it-81:PRP is-82:VBZ computed-83:VBN ,-84:, because-85:IN it-86:PRP will-87:MD be-88:VB reused-89:VBN .-90:. 1flatMap-1:NN has-2:VBZ the-3:DT same-4:JJ semantics-5:NNS as-6:IN the-7:DT map-8:NN in-9:IN MapReduce-10:NNP ,-11:, but-12:CC map-13:NN is-14:VBZ usually-15:RB used-16:VBN to-17:TO refer-18:VB to-19:TO a-20:DT one-to-one-21:JJ function-22:NN of-23:IN typeA-24:NN ⇒-25:NN B-26:NN in-27:IN Scala-28:NNP .-29:. 2This-1:NN is-2:VBZ how-3:WRB ``-4:`` distributed-5:VBN collections-6:NNS ''-7:'' function-8:NN in-9:IN DryadLINQ-10:NN .-11:. --1:: The-2:DT save-3:IN action-4:NN evaluates-5:VBZ the-6:DT dataset-7:NN and-8:CC writes-9:VBZ it-10:PRP to-11:TO a-12:DT distributed-13:VBN filesystem-14:NN such-15:JJ as-16:IN HDFS-17:NN .-18:. The-1:DT saved-2:VBN version-3:NN is-4:VBZ used-5:VBN in-6:IN future-7:JJ operations-8:NNS on-9:IN it-10:PRP .-11:. We-1:PRP note-2:VBP that-3:IN our-4:PRP$ cache-5:NN action-6:NN is-7:VBZ only-8:RB a-9:DT hint-10:NN :-11:: if-12:IN there-13:EX is-14:VBZ not-15:RB enough-16:JJ memory-17:NN in-18:IN the-19:DT cluster-20:NN to-21:TO cache-22:NN all-23:DT partitions-24:NNS of-25:IN a-26:DT dataset-27:NN ,-28:, Spark-29:NNP will-30:MD recompute-31:VB them-32:PRP when-33:WRB they-34:PRP are-35:VBP used-36:VBN .-37:. We-1:PRP chose-2:VBD this-3:DT design-4:NN so-5:IN that-6:IN Spark-7:NN programs-8:NNS keep-9:VBP working-10:VBG -LRB--11:-LRB- at-12:IN reduced-13:VBN performance-14:NN -RRB--15:-RRB- if-16:IN nodes-17:NNS fail-18:VBP or-19:CC if-20:IN a-21:DT dataset-22:NN is-23:VBZ too-24:RB big-25:JJ .-26:. This-1:DT idea-2:NN is-3:VBZ loosely-4:RB analogous-5:JJ to-6:TO virtual-7:JJ memory-8:NN .-9:. We-1:PRP also-2:RB plan-3:VBP to-4:TO extend-5:VB Spark-6:NN to-7:TO support-8:VB other-9:JJ levels-10:NNS of-11:IN persistence-1:NN -LRB--2:-LRB- e.g.-3:FW ,-4:, in-memory-5:JJ replication-6:NN across-7:IN multiple-8:JJ nodes-9:NNS -RRB--10:-RRB- .-11:. Our-1:PRP$ goal-2:NN is-3:VBZ to-4:TO let-5:VB users-6:NNS trade-7:VB off-8:RP between-9:IN the-10:DT cost-11:NN of-12:IN storing-13:VBG an-14:DT RDD-15:NN ,-16:, the-17:DT speed-18:NN of-19:IN accessing-20:VBG it-21:PRP ,-22:, the-23:DT probability-24:NN of-25:IN losing-26:VBG part-27:NN of-28:IN it-29:PRP ,-30:, and-31:CC the-32:DT cost-33:NN of-34:IN recomputing-35:VBG it-36:PRP .-37:. 2.2-1:CD Parallel-2:JJ Operations-3:NNP Several-1:JJ parallel-2:JJ operations-3:NNS can-4:MD be-5:VB performed-6:VBN on-7:IN RDDs-8:NNS :-9:: •-1:NN reduce-2:VB :-3:: Combines-4:VBZ dataset-5:JJ elements-6:NNS using-7:VBG an-8:DT associative-9:JJ function-10:NN to-11:TO produce-12:VB a-13:DT result-14:NN at-15:IN the-16:DT driver-17:NN program-18:NN .-19:. •-1:RB collect-2:VB :-3:: Sends-4:VBZ all-5:DT elements-6:NNS of-7:IN the-8:DT dataset-9:NN to-10:TO the-11:DT driver-12:NN program-13:NN .-14:. For-1:IN example-2:NN ,-3:, an-4:DT easy-5:JJ way-6:NN to-7:TO update-8:VB an-9:DT array-10:NN in-11:IN parallel-12:NN is-13:VBZ to-14:TO parallelize-15:VB ,-16:, map-17:VB and-18:CC collect-19:VB the-20:DT array-21:NN .-22:. •-1:NN foreach-2:NN :-3:: Passes-4:VBZ each-5:DT element-6:NN through-7:IN a-8:DT user-9:NN provided-10:VBN function-11:NN .-12:. This-1:DT is-2:VBZ only-3:RB done-4:VBN for-5:IN the-6:DT side-7:JJ effects-8:NNS of-9:IN the-10:DT function-11:NN -LRB--12:-LRB- which-13:WDT might-14:MD be-15:VB to-16:TO copy-17:VB data-18:NNS to-19:TO another-20:DT system-21:NN or-22:CC to-23:TO update-24:VB a-25:DT shared-26:JJ variable-27:NN as-28:IN explained-29:VBN below-30:IN -RRB--31:-RRB- .-32:. We-1:PRP note-2:VBP that-3:IN Spark-4:NN does-5:VBZ not-6:RB currently-7:RB support-8:VBP a-9:DT grouped-10:VBN reduce-11:VB operation-12:NN as-13:IN in-14:IN MapReduce-15:NNP ;-16:: reduce-17:VB results-18:NNS are-19:VBP only-20:RB collected-21:VBN at-22:IN one-23:CD process-24:NN -LRB--25:-LRB- the-26:DT driver-27:NN -RRB--28:-RRB- .3-29:NN We-30:PRP plan-31:VBP to-32:TO support-33:VB grouped-34:VBN reductions-35:NNS in-36:IN the-37:DT future-38:NN using-39:VBG a-40:DT ``-41:`` shuffle-42:NN ''-43:'' transformation-44:NN on-45:IN distributed-46:VBN datasets-47:NNS ,-48:, as-49:IN described-50:VBN in-51:IN Section-52:NN 7-53:CD .-54:. However-1:RB ,-2:, even-3:RB using-4:VBG a-5:DT single-6:JJ reducer-7:NN is-8:VBZ enough-9:RB to-10:TO express-11:VB a-12:DT variety-13:NN of-14:IN useful-15:JJ algorithms-16:NNS .-17:. For-1:IN example-2:NN ,-3:, a-4:DT recent-5:JJ paper-6:NN on-7:IN MapReduce-8:NNP for-9:IN machine-10:NN learning-11:NN on-12:IN multicore-13:JJ systems-14:NNS -LSB--15:-LRB- 10-16:CD -RSB--17:-RRB- implemented-18:VBD ten-19:CD learning-20:VBG algorithms-21:NNS without-22:IN supporting-23:VBG parallel-24:JJ reduction-25:NN .-26:. 2.3-1:CD Shared-2:VBN Variables-3:NNS Programmers-1:NNS invoke-2:VBP operations-3:NNS like-4:IN map-5:NN ,-6:, filter-7:NN and-8:CC reduce-9:VB by-10:IN passing-11:VBG closures-12:NNS -LRB--13:-LRB- functions-14:NNS -RRB--15:-RRB- to-16:TO Spark-17:VB .-18:. As-1:IN is-2:VBZ typical-3:JJ in-4:IN functional-5:JJ programming-6:NN ,-7:, these-8:DT closures-9:NNS can-10:MD refer-11:VB to-12:TO variables-13:NNS in-14:IN the-15:DT scope-16:NN where-17:WRB they-18:PRP are-19:VBP created-20:VBN .-21:. Normally-1:RB ,-2:, when-3:WRB Spark-4:NNP runs-5:VBZ a-6:DT closure-7:NN on-8:IN a-9:DT worker-10:NN node-11:NN ,-12:, these-13:DT variables-14:NNS are-15:VBP copied-16:VBN to-17:TO the-18:DT worker-19:NN .-20:. However-1:RB ,-2:, Spark-3:NN also-4:RB lets-5:VBZ programmers-6:NNS create-7:VB two-8:CD restricted-9:JJ types-10:NNS of-11:IN shared-12:JJ variables-13:NNS to-14:TO support-15:VB two-16:CD simple-17:JJ but-18:CC common-19:JJ usage-20:NN patterns-21:NNS :-22:: •-1:NN Broadcast-2:NNP variables-3:NNS :-4:: If-5:IN a-6:DT large-7:JJ read-only-8:JJ piece-9:NN of-10:IN data-11:NNS -LRB--12:-LRB- e.g.-13:FW ,-14:, a-15:DT lookup-16:NN table-17:NN -RRB--18:-RRB- is-19:VBZ used-20:VBN in-21:IN multiple-22:JJ parallel-23:JJ operations-24:NNS ,-25:, it-26:PRP is-27:VBZ preferable-28:JJ to-29:TO distribute-30:VB it-31:PRP to-32:TO the-33:DT workers-34:NNS only-35:RB once-36:RB instead-37:RB of-38:IN packaging-39:NN it-40:PRP with-41:IN every-42:DT closure-43:NN .-44:. Spark-1:VB lets-2:VBZ the-3:DT programmer-4:NN create-5:VB a-6:DT ``-7:`` broadcast-8:NN vari-9:NN --10:: 3Local-1:JJ reductions-2:NNS are-3:VBP first-4:JJ performed-5:VBN at-6:IN each-7:DT node-8:NN ,-9:, however-10:RB .-11:. able-1:JJ ''-2:'' object-3:NN that-4:WDT wraps-5:VBZ the-6:DT value-7:NN and-8:CC ensures-9:VBZ that-10:IN it-11:PRP is-12:VBZ only-13:RB copied-14:VBN to-15:TO each-16:DT worker-17:NN once-18:RB .-19:. •-1:NN Accumulators-2:NNS :-3:: These-4:DT are-5:VBP variables-6:NNS that-7:WDT workers-8:NNS can-9:MD only-10:RB ``-11:`` add-12:VB ''-13:'' to-14:TO using-15:VBG an-16:DT associative-17:JJ operation-18:NN ,-19:, and-20:CC that-21:IN only-22:RB the-23:DT driver-24:NN can-25:MD read-26:VB .-27:. They-1:PRP can-2:MD be-3:VB used-4:VBN to-5:TO implement-6:VB counters-7:NNS as-8:IN in-9:IN MapReduce-10:NNP and-11:CC to-12:TO provide-13:VB a-14:DT more-15:RBR imperative-16:JJ syntax-17:NN for-18:IN parallel-19:JJ sums-20:NNS .-21:. Accumulators-1:NNS can-2:MD be-3:VB defined-4:VBN for-5:IN any-6:DT type-7:NN that-8:WDT has-9:VBZ an-10:DT ``-11:`` add-12:VB ''-13:'' operation-14:NN and-15:CC a-16:DT ``-17:`` zero-18:NN ''-19:'' value-20:NN .-21:. Due-1:JJ to-2:TO their-3:PRP$ ``-4:`` add-only-5:JJ ''-6:'' semantics-7:NNS ,-8:, they-9:PRP are-10:VBP easy-11:JJ to-12:TO make-13:VB fault-tolerant-14:JJ .-15:. 3-1:CD Examples-2:NNS We-3:PRP now-4:RB show-5:VBP some-6:DT sample-7:NN Spark-8:NN programs-9:NNS .-10:. Note-1:VB that-2:IN we-3:PRP omit-4:VBP variable-5:JJ types-6:NNS because-7:IN Scala-8:NNP supports-9:VBZ type-10:NN inference-11:NN .-12:. 3.1-1:CD Text-2:VB Search-3:VB Suppose-1:VB that-2:IN we-3:PRP wish-4:VBP to-5:TO count-6:VB the-7:DT lines-8:NNS containing-9:VBG errors-10:NNS in-11:IN a-12:DT large-13:JJ log-14:NN file-15:NN stored-16:VBN in-17:IN HDFS-18:NN .-19:. This-1:DT can-2:MD be-3:VB implemented-4:VBN by-5:IN starting-6:VBG with-7:IN a-8:DT file-9:NN dataset-10:NN object-11:NN as-12:IN follows-13:VBZ :-14:: val-1:NN file-2:NN =-3:JJ spark.textFile-4:NN -LRB--5:-LRB- ``-6:`` hdfs-7:NNS :-8:: /-9:: /-10:: ...-11:: ''-12:'' -RRB--13:-RRB- val-14:NN errs-15:VBZ =-16:JJ file.filter-17:NN -LRB--18:-LRB- _-19:CD .-20:. contains-1:VBZ -LRB--2:-LRB- ``-3:`` ERROR-4:NN ''-5:'' -RRB--6:-RRB- -RRB--7:-RRB- val-8:JJ ones-9:NNS =-10:JJ errs.map-11:NN -LRB--12:-LRB- _-13:NN =-14:JJ >-15:JJR 1-16:LS -RRB--17:-RRB- val-18:NN count-19:NN =-20:JJ ones.reduce-21:NN -LRB--22:-LRB- _-23:NN +-24:CC _-25:NN -RRB--26:-RRB- We-1:PRP first-2:RB create-3:VB a-4:DT distributed-5:VBN dataset-6:NN called-7:VBN file-8:NN that-9:WDT represents-10:VBZ the-11:DT HDFS-12:NN file-13:NN as-14:IN a-15:DT collection-16:NN of-17:IN lines-18:NNS .-19:. We-1:PRP transform-2:VBP this-3:DT dataset-4:NN to-5:TO create-6:VB the-7:DT set-8:NN of-9:IN lines-10:NNS containing-11:VBG ``-12:`` ERROR-13:NN ''-14:'' -LRB--15:-LRB- errs-16:VBZ -RRB--17:-RRB- ,-18:, and-19:CC then-20:RB map-21:VB each-22:DT line-23:NN to-24:TO a-25:DT 1-26:CD and-27:CC add-28:VB up-29:RP these-30:DT ones-31:NNS using-32:VBG reduce-33:VB .-34:. The-1:DT arguments-2:NNS to-3:TO filter-4:NN ,-5:, map-6:NN and-7:CC reduce-8:VB are-9:VBP Scala-10:NNP syntax-11:NNP for-12:IN function-13:NN literals-14:NNS .-15:. Note-1:VB that-2:DT errs-3:VBZ and-4:CC ones-5:NNS are-6:VBP lazy-7:JJ RDDs-8:NNS that-9:WDT are-10:VBP never-11:RB materialized-1:VBD .-2:. Instead-1:RB ,-2:, when-3:WRB reduce-4:VB is-5:VBZ called-6:VBN ,-7:, each-8:DT worker-9:NN node-10:NN scans-11:VBZ input-12:NN blocks-13:NNS in-14:IN a-15:DT streaming-16:NN manner-17:NN to-18:TO evaluate-19:VB ones-20:NNS ,-21:, adds-22:VBZ these-23:DT to-24:TO perform-25:VB a-26:DT local-27:JJ reduce-28:VB ,-29:, and-30:CC sends-31:VBZ its-32:PRP$ local-33:JJ count-34:NN to-35:TO the-36:DT driver-37:NN .-38:. When-1:WRB used-2:VBN with-3:IN lazy-4:JJ datasets-5:NNS in-6:IN this-7:DT manner-8:NN ,-9:, Spark-10:NN closely-11:RB emulates-12:VBZ MapReduce-13:NNP .-14:. Where-1:WRB Spark-2:NNP differs-3:VBZ from-4:IN other-5:JJ frameworks-6:NNS is-7:VBZ that-8:IN it-9:PRP can-1:MD make-2:VB some-3:DT of-4:IN the-5:DT intermediate-6:JJ datasets-7:NNS persist-8:VBP across-9:IN operations-10:NNS .-11:. For-1:IN example-2:NN ,-3:, if-4:IN wanted-5:VBN to-6:TO reuse-7:VB the-8:DT errs-9:VBZ dataset-10:NN ,-11:, we-12:PRP could-13:MD create-14:VB a-15:DT cached-16:JJ RDD-17:NN from-18:IN it-19:PRP as-20:IN follows-21:VBZ :-22:: val-1:NN cachedErrs-2:NNS =-3:JJ errs.cache-4:NN -LRB--5:-LRB- -RRB--6:-RRB- We-1:PRP would-2:MD now-3:RB be-4:VB able-5:JJ to-6:TO invoke-7:VB parallel-8:JJ operations-9:NNS on-10:IN cachedErrs-11:NNS or-12:CC on-13:IN datasets-14:NNS derived-15:VBN from-16:IN it-17:PRP as-18:IN usual-19:JJ ,-20:, but-21:CC nodes-22:NNS would-23:MD cache-24:NN partitions-25:NNS of-26:IN cachedErrs-27:NNS in-28:IN memory-29:NN after-30:IN the-31:DT first-32:JJ time-33:NN they-34:PRP compute-35:VBP them-36:PRP ,-37:, greatly-38:RB speeding-39:VBG up-40:RP subsequent-41:JJ operations-42:NNS on-43:IN it-44:PRP .-45:. 3.2-1:CD Logistic-2:NNP Regression-3:NN The-1:DT following-2:VBG program-3:NN implements-4:VBZ logistic-5:JJ regression-6:NN -LSB--7:-LRB- 3-8:CD -RSB--9:-RRB- ,-10:, an-11:DT iterative-12:JJ classification-13:NN algorithm-14:NN that-15:WDT attempts-16:VBZ to-17:TO find-18:VB a-19:DT hyperplane-20:NN w-21:NN that-22:WDT best-23:JJS separates-24:VBZ two-25:CD sets-26:NNS of-27:IN points-28:NNS .-29:. The-1:DT algorithm-2:NN performs-3:VBZ gradient-4:NN descent-5:NN :-6:: it-7:PRP starts-8:VBZ w-9:RB at-10:IN a-11:DT random-12:JJ value-13:NN ,-14:, and-15:CC on-16:IN each-17:DT iteration-18:NN ,-19:, it-20:PRP sums-21:VBZ a-22:DT function-23:NN of-24:IN w-25:NN over-26:IN the-27:DT data-28:NNS to-29:TO move-30:VB w-31:RB in-32:IN a-33:DT direction-34:NN that-35:WDT improves-36:VBZ it-37:PRP .-38:. It-1:PRP thus-2:RB benefits-3:VBZ greatly-4:RB from-5:IN caching-6:VBG the-7:DT data-8:NNS in-9:IN memory-10:NN across-11:IN iterations-12:NNS .-13:. We-1:PRP do-2:VBP not-3:RB explain-4:VB logistic-5:JJ regression-6:NN in-7:IN detail-8:NN ,-9:, but-10:CC we-11:PRP use-12:VBP it-13:PRP to-14:TO show-15:VB a-16:DT few-17:JJ new-18:JJ Spark-19:NN features-20:NNS .-21:. /-1:: /-2:: Read-3:VB points-4:NNS from-5:IN a-6:DT text-7:NN file-8:NN and-9:CC cache-10:NN them-11:PRP val-12:JJ points-13:NNS =-14:JJ spark.textFile-15:NN -LRB--16:-LRB- ...-17:: -RRB--18:-RRB- .-1:. map-1:NN -LRB--2:-LRB- parsePoint-3:NN -RRB--4:-RRB- .-5:. cache-1:NN -LRB--2:-LRB- -RRB--3:-RRB- /-4:: /-5:: Initialize-6:VB w-7:NN to-8:TO random-9:JJ D-dimensional-10:JJ vector-11:NN var-12:NN w-13:NN =-14:JJ Vector.random-15:NN -LRB--16:-LRB- D-17:NN -RRB--18:-RRB- /-19:: /-20:: Run-21:NNP multiple-22:JJ iterations-23:NNS to-24:TO update-25:VB w-26:NN for-27:IN -LRB--28:-LRB- i-29:FW <-30:JJR --31:: 1-32:CD to-33:TO ITERATIONS-34:NNS -RRB--35:-RRB- -LCB--36:-LRB- val-37:NN grad-38:NN =-39:JJ spark.accumulator-40:NN -LRB--41:-LRB- new-42:JJ Vector-43:NNP -LRB--44:-LRB- D-45:NNP -RRB--46:-RRB- -RRB--47:-RRB- for-48:IN -LRB--49:-LRB- p-50:NN <-51:JJR --52:: points-53:NNS -RRB--54:-RRB- -LCB--55:-LRB- /-56:: /-57:: Runs-58:VBZ in-59:IN parallel-60:JJ val-61:NN s-62:NNS =-63:JJ -LRB--64:-LRB- 1-65:CD /-66:: -LRB--67:-LRB- 1-68:LS +-69:CC exp-70:NN -LRB--71:-LRB- --72:: p.y-73:NN *-74:NN -LRB--75:-LRB- w-76:NN dot-77:NN p.x-78:NN -RRB--79:-RRB- -RRB--80:-RRB- -RRB--81:-RRB- -1-82:CD -RRB--83:-RRB- *-84:SYM p.y-85:FW grad-86:FW +-87:CC =-88:JJ s-89:NNS *-90:SYM p.x-91:SYM -RCB--1:-RRB- w-2:SYM --3:: =-4:JJ grad.value-5:NN -RCB--1:-RRB- First-1:RB ,-2:, although-3:IN we-4:PRP create-5:VBP an-6:DT RDD-7:NN called-8:VBN points-9:NNS ,-10:, we-11:PRP process-12:VBP it-13:PRP by-14:IN running-15:VBG a-16:DT for-17:IN loop-18:NN over-19:IN it-20:PRP .-21:. The-1:DT for-2:IN keyword-3:NN in-4:IN Scala-5:NNP is-6:VBZ syntactic-7:JJ sugar-8:NN for-9:IN invoking-10:VBG the-11:DT foreach-12:NN method-13:NN of-14:IN a-15:DT collection-16:NN with-17:IN the-18:DT loop-19:NN body-20:NN as-21:IN a-22:DT closure-23:NN .-24:. That-1:DT is-2:VBZ ,-3:, the-4:DT code-5:NN for-6:IN -LRB--7:-LRB- p-8:NN <-9:JJR --10:: points-11:NNS -RRB--12:-RRB- -LCB--13:-LRB- body-14:NN -RCB--15:-RRB- is-16:VBZ equivalent-17:JJ to-18:TO points.foreach-19:NN -LRB--20:-LRB- p-21:NN =-22:JJ >-23:JJR -LCB--24:-LRB- body-25:NN -RCB--26:-RRB- -RRB--27:-RRB- .-28:. Therefore-1:RB ,-2:, we-3:PRP are-4:VBP invoking-5:VBG Spark-6:NNP 's-7:POS parallel-8:JJ foreach-9:NN operation-10:NN .-11:. Second-1:RB ,-2:, to-3:TO sum-4:VB up-5:RP the-6:DT gradient-7:NN ,-8:, we-9:PRP use-10:VBP an-11:DT accumulator-12:NN variable-1:JJ called-2:VBN gradient-3:NN -LRB--4:-LRB- with-5:IN a-6:DT value-7:NN of-8:IN type-9:NN V-10:NN ector-11:NN -RRB--12:-RRB- .-13:. Note-1:VB that-2:IN the-3:DT loop-4:NN adds-5:VBZ to-6:TO gradient-7:NN using-8:VBG an-9:DT overloaded-10:JJ +-11:CC =-12:JJ operator-13:NN .-14:. The-1:DT combination-2:NN of-3:IN accumulators-4:NNS and-5:CC for-6:IN syntax-7:NN allows-8:VBZ Spark-9:NN programs-10:NNS to-11:TO look-12:VB much-13:RB like-14:IN imperative-15:JJ serial-16:NN programs-17:NNS .-18:. Indeed-1:RB ,-2:, this-3:DT example-4:NN differs-5:VBZ from-6:IN a-7:DT serial-8:NN version-9:NN of-10:IN logistic-11:JJ regression-12:NN in-13:IN only-14:RB three-15:CD lines-16:NNS .-17:. 3.3-1:CD Alternating-2:VBG Least-3:NNP Squares-4:NNS Our-1:PRP$ final-2:JJ example-3:NN is-4:VBZ an-5:DT algorithm-6:NN called-7:VBN alternating-8:VBG least-9:JJS squares-10:NNS -LRB--11:-LRB- ALS-12:NNS -RRB--13:-RRB- .-14:. ALS-1:NNP is-2:VBZ used-3:VBN for-4:IN collaborative-5:JJ filtering-6:VBG problems-7:NNS ,-8:, such-9:JJ as-10:IN predicting-11:VBG users-12:NNS '-13:POS ratings-14:NNS for-15:IN movies-16:NNS that-17:IN they-18:PRP have-19:VBP not-20:RB seen-21:VBN based-22:VBN on-23:IN their-24:PRP$ movie-25:NN rating-26:NN history-27:NN -LRB--28:-LRB- as-29:IN in-30:IN the-31:DT Netflix-32:NNP Challenge-33:NNP -RRB--34:-RRB- .-35:. Unlike-1:IN our-2:PRP$ previous-3:JJ examples-4:NNS ,-5:, ALS-6:NNP is-7:VBZ CPU-intensive-8:JJ rather-9:RB than-10:IN data-intensive-11:JJ .-12:. We-1:PRP briefly-2:RB sketch-3:NN ALS-4:NNP and-5:CC refer-6:VB the-7:DT reader-8:NN to-9:TO -LSB--10:-LRB- 27-11:CD -RSB--12:-RRB- for-13:IN details-1:NNS .-2:. Suppose-1:VB that-2:IN we-3:PRP wanted-4:VBD to-5:TO predict-6:VB the-7:DT ratings-8:NNS of-9:IN u-10:NN users-11:NNS form-12:VBP movies-13:NNS ,-14:, and-15:CC that-16:IN we-17:PRP had-18:VBD a-19:DT partially-20:RB filled-21:VBN matrix-22:NN R-23:NN containing-24:VBG the-25:DT known-26:JJ ratings-27:NNS for-28:IN some-29:DT user-movie-30:JJ pairs-31:NNS .-32:. ALS-1:NNP models-2:NNS R-3:NN as-4:IN the-5:DT product-6:NN of-7:IN two-8:CD matrices-9:NNS M-10:NN and-11:CC U-12:NN of-13:IN dimensions-14:NNS m-15:NN ×-16:CD k-17:NN and-18:CC k-19:NN ×-20:CD u-21:NN respectively-22:RB ;-23:: that-24:WDT is-25:VBZ ,-26:, each-27:DT user-28:NN and-29:CC each-30:DT movie-31:NN has-32:VBZ a-33:DT k-dimensional-34:JJ ``-35:`` feature-36:NN vector-37:NN ''-38:'' describing-39:VBG its-40:PRP$ characteristics-41:NNS ,-42:, and-43:CC a-44:DT user-45:NN 's-46:POS rating-47:NN for-48:IN a-49:DT movie-50:NN is-51:VBZ the-52:DT dot-53:NN product-54:NN of-55:IN its-56:PRP$ feature-57:NN vector-58:NN and-59:CC the-60:DT movie-61:NN 's-62:POS .-63:. ALS-1:NNP solves-2:VBZ for-3:IN M-4:NN and-5:CC U-6:NN using-7:VBG the-8:DT known-9:JJ ratings-10:NNS and-11:CC then-12:RB computes-13:VBZ M-14:NN ×-15:CD U-16:NNP to-17:TO predict-18:VB the-19:DT unknown-20:JJ ones-21:NNS .-22:. This-1:DT is-2:VBZ done-3:VBN using-4:VBG the-5:DT following-6:VBG iterative-7:JJ process-8:NN :-9:: 1-10:CD .-11:. InitializeM-1:NN to-2:TO a-3:DT random-4:JJ value-5:NN .-6:. 2-1:LS .-2:. Optimize-1:VB U-2:NNP givenM-3:NNP to-4:TO minimize-5:VB error-6:NN on-7:IN R.-8:NNP 3-1:LS .-2:. OptimizeM-1:NN given-2:VBN U-3:NNP to-4:TO minimize-5:VB error-6:NN on-7:IN R.-8:NNP 4-9:CD .-10:. Repeat-1:NN steps-2:NNS 2-3:CD and-4:CC 3-5:CD until-6:IN convergence-7:NN .-8:. ALS-1:NNP can-2:MD be-3:VB parallelized-4:VBN by-5:IN updating-6:VBG different-7:JJ users-8:NNS /-9:: movies-1:NNS on-2:IN each-3:DT node-4:NN in-5:IN steps-6:NNS 2-7:CD and-8:CC 3-9:CD .-10:. However-1:RB ,-2:, because-3:IN all-4:DT of-5:IN the-6:DT steps-7:NNS use-8:VBP R-9:NN ,-10:, it-11:PRP is-12:VBZ helpful-13:JJ to-14:TO make-15:VB R-16:NN a-17:DT broadcast-18:NN variable-19:NN so-20:IN that-21:IN it-22:PRP does-23:VBZ not-24:RB get-25:VB re-sent-26:JJ to-27:TO each-28:DT node-29:NN on-30:IN each-31:DT step-32:NN .-33:. A-1:DT Spark-2:NN implementation-3:NN of-4:IN ALS-5:NNP that-6:WDT does-7:VBZ is-8:VBZ shown-9:VBN below-10:IN .-11:. Note-1:VB that-2:IN we-3:PRP parallelize-4:VBP the-5:DT collection-6:NN 0-7:CD until-8:IN u-9:NN -LRB--10:-LRB- a-11:DT Scala-12:NN range-13:NN object-14:NN -RRB--15:-RRB- and-16:CC collect-17:VB it-18:PRP to-19:TO update-20:VB each-21:DT array-22:NN :-23:: val-1:NN Rb-2:NN =-3:JJ spark.broadcast-4:NN -LRB--5:-LRB- R-6:NN -RRB--7:-RRB- for-8:IN -LRB--9:-LRB- i-10:FW <-11:JJR --12:: 1-13:CD to-14:TO ITERATIONS-15:NNS -RRB--16:-RRB- -LCB--17:-LRB- U-18:NN =-19:JJ spark.parallelize-20:NN -LRB--21:-LRB- 0-22:CD until-23:IN u-24:NN -RRB--25:-RRB- .-1:. map-1:NN -LRB--2:-LRB- j-3:NN =-4:JJ >-5:JJR updateUser-6:NN -LRB--7:-LRB- j-8:NN ,-9:, Rb-10:NN ,-11:, M-12:NN -RRB--13:-RRB- -RRB--14:-RRB- .-1:. collect-1:VB -LRB--2:-LRB- -RRB--3:-RRB- M-4:NN =-5:JJ spark.parallelize-6:NN -LRB--7:-LRB- 0-8:CD until-9:IN m-10:NN -RRB--11:-RRB- .-1:. map-1:NN -LRB--2:-LRB- j-3:NN =-4:JJ >-5:JJR updateUser-6:NN -LRB--7:-LRB- j-8:NN ,-9:, Rb-10:NN ,-11:, U-12:NNP -RRB--13:-RRB- -RRB--14:-RRB- .-1:. collect-1:VB -LRB--2:-LRB- -RRB--3:-RRB- -RCB--4:-RRB- 4-1:LS Implementation-2:NN Spark-3:NN is-4:VBZ built-5:VBN on-6:IN top-7:NN of-8:IN Mesos-9:FW -LSB--10:-LRB- 16-11:CD ,-12:, 15-13:CD -RSB--14:-RRB- ,-15:, a-16:DT ``-17:`` cluster-18:NN operating-19:NN system-20:NN ''-21:'' that-22:WDT lets-23:VBZ multiple-24:JJ parallel-25:NN applications-26:NNS share-27:VBP a-28:DT cluster-29:NN in-30:IN a-31:DT fine-grained-32:JJ manner-33:NN and-34:CC provides-35:VBZ an-36:DT API-37:NN for-38:IN applications-39:NNS to-40:TO launch-41:VB tasks-42:NNS on-43:IN a-44:DT cluster-45:NN .-46:. This-1:DT allows-2:VBZ Spark-3:NNP to-4:TO run-5:VB alongside-6:IN existing-7:VBG cluster-8:NN computing-9:NN frameworks-10:NNS ,-11:, such-12:JJ as-13:IN Mesos-14:NNP ports-15:NNS of-16:IN Hadoop-17:NNP andMPI-18:NNP ,-19:, and-20:CC share-21:NN data-22:NNS with-23:IN them-24:PRP .-25:. In-1:IN addition-2:NN ,-3:, building-4:VBG on-5:IN Mesos-6:NNP greatly-7:RB reduced-8:VBD the-9:DT programming-10:NN effort-11:NN that-12:WDT had-13:VBD to-14:TO go-15:VB into-16:IN Spark-17:NNP .-18:. The-1:DT core-2:NN of-3:IN Spark-4:NNP is-5:VBZ the-6:DT implementation-7:NN of-8:IN resilient-9:JJ dis-10:SYM --11:: tributed-1:JJ datasets-2:NNS .-3:. As-1:IN an-2:DT example-3:NN ,-4:, suppose-5:VBP that-6:IN we-7:PRP define-8:VBP a-9:DT cached-10:VBN dataset-11:NN called-12:VBN cachedErrs-13:NNS representing-14:VBG error-15:NN messages-16:NNS in-17:IN a-18:DT log-19:NN file-20:NN ,-21:, and-22:CC that-23:IN we-24:PRP count-25:VBP its-26:PRP$ elements-27:NNS using-28:VBG map-29:NN and-30:CC reduce-31:VB ,-32:, as-33:IN in-34:IN Section-35:NN 3.1-36:CD :-37:: val-1:NN file-2:NN =-3:JJ spark.textFile-4:NN -LRB--5:-LRB- ``-6:`` hdfs-7:NNS :-8:: /-9:: /-10:: ...-11:: ''-12:'' -RRB--13:-RRB- val-14:NN errs-15:VBZ =-16:JJ file.filter-17:NN -LRB--18:-LRB- _-19:CD .-20:. contains-1:VBZ -LRB--2:-LRB- ``-3:`` ERROR-4:NN ''-5:'' -RRB--6:-RRB- -RRB--7:-RRB- val-8:NN cachedErrs-9:NN =-10:JJ errs.cache-11:NN -LRB--12:-LRB- -RRB--13:-RRB- val-14:JJ ones-15:NNS =-16:JJ cachedErrs.map-17:NN -LRB--18:-LRB- _-19:NN =-20:JJ >-21:JJR 1-22:LS -RRB--23:-RRB- val-24:NN count-25:NN =-26:JJ ones.reduce-27:NN -LRB--28:-LRB- _-29:NN +-30:CC _-31:NN -RRB--32:-RRB- These-1:DT datasets-2:NNS will-3:MD be-4:VB stored-5:VBN as-6:IN a-7:DT chain-8:NN of-9:IN objects-10:NNS capturing-11:VBG the-12:DT lineage-13:NN of-14:IN each-15:DT RDD-16:NN ,-17:, shown-18:VBN in-19:IN Figure-20:NNP 1-21:CD .-22:. Each-1:DT dataset-2:NN object-3:NN contains-4:VBZ a-5:DT pointer-6:NN to-7:TO its-8:PRP$ parent-9:NN and-10:CC information-11:NN about-12:IN how-13:WRB the-14:DT parent-15:NN was-16:VBD transformed-17:VBN .-18:. Internally-1:RB ,-2:, each-3:DT RDD-4:NN object-5:NN implements-6:VBZ the-7:DT same-8:JJ sim-9:NN --10:: ple-1:NN interface-2:NN ,-3:, which-4:WDT consists-5:VBZ of-6:IN three-7:CD operations-8:NNS :-9:: •-10:CD getPartitions-11:NNS ,-12:, which-13:WDT returns-14:VBZ a-15:DT list-16:NN of-17:IN partition-18:NN IDs-19:NNS .-20:. •-1:NN getIterator-2:NN -LRB--3:-LRB- partition-4:NN -RRB--5:-RRB- ,-6:, which-7:WDT iterates-8:VBZ over-9:IN a-10:DT partition-11:NN .-12:. •-1:NN getPreferredLocations-2:NNS -LRB--3:-LRB- partition-4:NN -RRB--5:-RRB- ,-6:, which-7:WDT is-8:VBZ used-9:VBN for-10:IN task-11:NN scheduling-12:NN to-13:TO achieve-14:VB data-15:NNS locality-16:NN .-17:. When-1:WRB a-2:DT parallel-3:JJ operation-4:NN is-5:VBZ invoked-6:VBN on-7:IN a-8:DT dataset-9:NN ,-10:, Spark-11:NN creates-1:VBZ a-2:DT task-3:NN to-4:TO process-5:VB each-6:DT partition-7:NN of-8:IN the-9:DT dataset-10:NN and-11:CC sends-12:VBZ these-13:DT tasks-14:NNS to-15:TO worker-16:NN nodes-17:NNS .-18:. We-1:PRP try-2:VBP to-3:TO send-4:VB each-5:DT HdfsTextFile-1:NNP path-2:NN =-3:JJ hdfs-4:NNS :-5:: /-6:: /-7:: ...-8:: file-9:NN :-10:: FilteredDataset-11:NNP func-12:NN =-13:JJ _-14:CD .-15:. contains-1:VBZ -LRB--2:-LRB- ...-3:: -RRB--4:-RRB- CachedDataset-5:NNP errs-6:VBZ :-7:: cachedErrs-8:NNS :-9:: MappedDataset-10:NNP func-11:NN =-12:JJ _-13:NN =-14:JJ >-15:JJR 1-16:CD ones-17:NNS :-18:: Figure-1:NNP 1-2:CD :-3:: Lineage-4:NN chain-5:NN for-6:IN the-7:DT distributed-8:VBN dataset-9:NN objects-10:NNS defined-11:VBN in-12:IN the-13:DT example-14:NN in-15:IN Section-16:NN 4-17:CD .-18:. task-1:NN to-2:TO one-3:CD of-4:IN its-5:PRP$ preferred-6:JJ locations-7:NNS using-8:VBG a-9:DT technique-10:NN called-11:VBN delay-12:NN scheduling-13:NN -LSB--14:-LRB- 26-15:CD -RSB--16:-RRB- .-17:. Once-1:RB launched-2:VBN on-3:IN a-4:DT worker-5:NN ,-6:, each-7:DT task-8:NN calls-9:VBZ getIterator-10:NN to-11:TO start-12:VB reading-13:VBG its-14:PRP$ partition-15:NN .-16:. The-1:DT different-2:JJ types-3:NNS of-4:IN RDDs-5:NNS differ-6:VBP only-7:RB in-8:IN how-9:WRB they-10:PRP implement-1:VB the-2:DT RDD-3:NN interface-4:NN .-5:. For-1:IN example-2:NN ,-3:, for-4:IN a-5:DT Hdfs-TextFile-6:NNP ,-7:, the-8:DT partitions-9:NNS are-10:VBP block-11:NN IDs-12:NNS in-13:IN HDFS-14:NN ,-15:, their-16:PRP$ preferred-17:VBN locations-18:NNS are-19:VBP the-20:DT block-21:NN locations-22:NNS ,-23:, and-24:CC getIterator-25:NN opens-26:VBZ a-27:DT stream-28:NN to-29:TO read-30:VB a-31:DT block-32:NN .-33:. In-1:IN a-2:DT MappedDataset-3:NNP ,-4:, the-5:DT partitions-6:NNS and-7:CC preferred-8:VBN locations-9:NNS are-10:VBP the-11:DT same-12:JJ as-13:IN for-14:IN the-15:DT parent-16:NN ,-17:, but-18:CC the-19:DT iterator-20:NN applies-21:VBZ the-22:DT map-23:NN function-24:NN to-25:TO elements-26:NNS of-27:IN the-28:DT parent-29:NN .-30:. Finally-1:RB ,-2:, in-3:IN a-4:DT CachedDataset-5:NNP ,-6:, the-7:DT getIterator-8:NN method-9:NN looks-10:VBZ for-11:IN a-12:DT locally-13:RB cached-14:VBN copy-15:NN of-16:IN a-17:DT transformed-18:VBN partition-19:NN ,-20:, and-21:CC each-22:DT partition-23:NN 's-24:POS preferred-25:JJ locations-26:NNS start-27:VBP out-28:RP equal-29:JJ to-30:TO the-31:DT parent-32:NN 's-33:POS preferred-34:JJ locations-35:NNS ,-36:, but-37:CC get-38:VB updated-39:VBN after-40:IN the-41:DT partition-42:NN is-43:VBZ cached-44:VBN on-45:IN some-46:DT node-47:NN to-48:TO prefer-49:VB reusing-50:VBG that-51:IN node-52:NN .-53:. This-1:DT design-2:NN makes-3:VBZ faults-4:NNS easy-5:JJ to-6:TO handle-7:VB :-8:: if-9:IN a-10:DT node-11:NN fails-12:VBZ ,-13:, its-14:PRP$ partitions-15:NNS are-16:VBP re-read-17:JJ from-18:IN their-19:PRP$ parent-20:NN datasets-21:NNS and-22:CC eventually-23:RB cached-24:VBN on-25:IN other-26:JJ nodes-27:NNS .-28:. Finally-1:RB ,-2:, shipping-3:VBG tasks-4:NNS to-5:TO workers-6:NNS requires-7:VBZ shipping-8:NN closures-1:NNS to-2:TO them-both-3:VB the-4:DT closures-5:NNS used-6:VBN to-7:TO define-8:VB a-9:DT distributed-10:VBN dataset-11:NN ,-12:, and-13:CC closures-14:NNS passed-15:VBD to-16:TO operations-17:NNS such-18:JJ as-19:IN reduce-20:VB .-21:. To-1:TO achieve-2:VB this-3:DT ,-4:, we-5:PRP rely-6:VBP on-7:IN the-8:DT fact-9:NN that-10:IN Scala-11:NNP closures-12:NNS are-13:VBP Java-14:NNP objects-15:NNS and-16:CC can-17:MD be-18:VB serialized-19:VBN using-20:VBG Java-21:NNP serialization-22:NN ;-23:: this-24:DT is-25:VBZ a-26:DT feature-27:NN of-28:IN Scala-29:NNP that-30:WDT makes-31:VBZ it-32:PRP relatively-33:RB straightforward-34:JJ to-35:TO send-36:VB a-37:DT computation-38:NN to-39:TO another-40:DT machine-41:NN .-42:. Scala-1:NNP 's-2:POS built-in-3:JJ closure-4:NN implementation-5:NN is-6:VBZ not-7:RB ideal-8:JJ ,-9:, however-10:RB ,-11:, because-12:IN we-13:PRP have-14:VBP found-15:VBN cases-16:NNS where-17:WRB a-18:DT closure-19:NN object-20:NN references-21:NNS variables-22:NNS in-23:IN the-24:DT closure-25:NN 's-26:POS outer-27:JJ scope-28:NN that-29:WDT are-30:VBP not-31:RB actually-32:RB used-33:VBN in-34:IN its-35:PRP$ body-36:NN .-37:. We-1:PRP have-2:VBP filed-3:VBN a-4:DT bug-5:NN report-6:NN about-7:IN this-8:DT ,-9:, but-10:CC in-11:IN the-12:DT meantime-13:NN ,-14:, we-15:PRP have-16:VBP solved-17:VBN the-18:DT issue-19:NN by-20:IN performing-21:VBG a-22:DT static-23:JJ analysis-24:NN of-25:IN closure-26:NN classes-27:NNS '-28:POS byte-code-29:NN to-30:TO detect-31:VB these-32:DT unused-33:JJ variables-34:NNS and-35:CC set-36:VBD the-37:DT corresponding-38:JJ fields-39:NNS in-40:IN the-41:DT closure-42:NN object-43:NN to-44:TO null-45:NN .-46:. We-1:PRP omit-2:VBP the-3:DT details-4:NNS of-5:IN this-6:DT analysis-7:NN due-8:JJ to-9:TO lack-10:NN of-11:IN space-12:NN .-13:. Shared-1:VBN Variables-2:NNPS :-3:: The-4:DT two-5:CD types-6:NNS of-7:IN shared-8:JJ variables-9:NNS in-10:IN Spark-11:NNP ,-12:, broadcast-13:NN variables-14:NNS and-15:CC accumulators-16:NNS ,-17:, are-18:VBP implemented-19:VBN using-20:VBG classes-21:NNS with-22:IN custom-23:NN serialization-24:NN formats-25:NNS .-26:. When-1:WRB one-2:CD creates-3:VBZ a-4:DT broadcast-5:NN variable-6:JJ b-7:NN with-8:IN a-9:DT value-10:NN v-11:LS ,-12:, v-13:LS is-14:VBZ saved-15:VBN to-16:TO a-17:DT file-18:NN in-19:IN a-20:DT shared-21:JJ file-22:NN system-23:NN .-24:. The-1:DT serialized-2:JJ form-3:NN of-4:IN b-5:NN is-6:VBZ a-7:DT path-8:NN to-9:TO this-10:DT file-11:NN .-12:. When-1:WRB b-2:NN 's-3:POS value-4:NN is-5:VBZ queried-6:VBN on-7:IN a-8:DT worker-9:NN node-10:NN ,-11:, Spark-12:NN first-13:JJ checks-14:NNS whether-15:IN v-16:LS is-17:VBZ in-18:IN a-19:DT local-20:JJ cache-21:NN ,-22:, and-23:CC reads-24:VBZ it-25:PRP from-26:IN the-27:DT file-28:NN system-29:NN if-30:IN it-31:PRP is-32:VBZ n't-33:RB .-34:. We-1:PRP initially-2:RB used-3:VBD HDFS-4:NN to-5:TO broadcast-6:VB variables-7:NNS ,-8:, but-9:CC we-10:PRP are-11:VBP developing-12:VBG a-13:DT more-14:RBR efficient-15:JJ streaming-16:NN broadcast-17:NN system-18:NN .-19:. Accumulators-1:NNS are-2:VBP implemented-3:VBN using-4:VBG a-5:DT different-6:JJ ``-7:`` se-8:FW --9:: rialization-1:NN trick-2:NN .-3:. ''-4:'' Each-1:DT accumulator-2:NN is-3:VBZ given-4:VBN a-5:DT unique-6:JJ ID-7:NN when-8:WRB it-9:PRP is-10:VBZ created-11:VBN .-12:. When-1:WRB the-2:DT accumulator-3:NN is-4:VBZ saved-5:VBN ,-6:, its-7:PRP$ serialized-8:JJ form-9:NN contains-10:VBZ its-11:PRP$ ID-12:NNP and-13:CC the-14:DT ``-15:`` zero-16:NN ''-17:'' value-18:NN for-19:IN its-20:PRP$ type-21:NN .-22:. On-1:IN the-2:DT workers-3:NNS ,-4:, a-5:DT separate-6:JJ copy-7:NN of-8:IN the-9:DT accumulator-10:NN is-11:VBZ created-12:VBN for-13:IN each-14:DT thread-15:NN that-16:WDT runs-17:VBZ a-18:DT task-19:NN using-20:VBG thread-local-21:JJ variables-22:NNS ,-23:, and-24:CC is-25:VBZ reset-26:VB to-27:TO zero-28:CD when-29:WRB a-30:DT task-31:NN begins-32:VBZ .-33:. After-1:IN each-2:DT task-3:NN runs-4:VBZ ,-5:, the-6:DT worker-7:NN sends-8:VBZ a-9:DT message-10:NN to-11:TO the-12:DT driver-13:NN program-14:NN containing-15:VBG the-16:DT updates-17:NNS it-18:PRP made-19:VBD to-20:TO various-21:JJ accumulators-22:NNS .-23:. The-1:DT driver-2:NN applies-3:VBZ updates-4:NNS from-5:IN each-6:DT partition-7:NN of-8:IN each-9:DT operation-10:NN only-11:RB once-12:RB to-13:TO prevent-14:VB double-counting-15:NN when-16:WRB tasks-17:NNS are-18:VBP re-executed-19:JJ due-20:JJ to-21:TO failures-22:NNS .-23:. Interpreter-1:NN Integration-2:NN :-3:: Due-4:JJ to-5:TO lack-6:NN of-7:IN space-8:NN ,-9:, we-10:PRP only-11:RB sketch-12:NN how-13:WRB we-14:PRP have-15:VBP integrated-16:VBN Spark-17:NNP into-18:IN the-19:DT Scala-20:NNP interpreter-21:NN .-22:. The-1:DT Scala-2:NNP interpreter-3:NN normally-4:RB operates-5:VBZ by-6:IN compiling-7:VBG a-8:DT class-9:NN for-10:IN each-11:DT line-12:NN typed-13:VBN by-14:IN the-15:DT user-16:NN .-17:. This-1:DT class-2:NN includes-3:VBZ a-4:DT singleton-5:NN object-6:NN that-7:WDT contains-8:VBZ the-9:DT variables-10:NNS or-11:CC functions-12:NNS on-13:IN that-14:DT line-15:NN and-16:CC runs-17:VBZ the-18:DT line-19:NN 's-20:POS code-21:NN in-22:IN its-23:PRP$ constructor-24:NN .-25:. For-1:IN example-2:NN ,-3:, if-4:IN the-5:DT user-6:NN types-7:NNS var-8:NN x-9:NN =-10:JJ 5-11:CD followed-12:VBN by-13:IN println-14:NN -LRB--15:-LRB- x-16:NN -RRB--17:-RRB- ,-18:, the-19:DT interpreter-20:NN defines-21:VBZ a-22:DT class-23:NN -LRB--24:-LRB- say-25:VB Line1-26:NN -RRB--27:-RRB- containing-28:VBG x-29:NN and-30:CC causes-31:VBZ the-32:DT second-33:JJ line-34:NN to-35:TO compile-36:VB to-37:TO println-38:NN -LRB--39:-LRB- Line1.getInstance-40:NN -LRB--41:-LRB- -RRB--42:-RRB- .-43:. x-1:NN -RRB--2:-RRB- .-3:. These-1:DT classes-2:NNS are-3:VBP loaded-4:VBN into-5:IN the-6:DT JVM-7:NNP to-8:TO run-9:VB each-10:DT line-11:NN .-12:. To-1:TO make-2:VB the-3:DT interpreter-4:NN work-5:NN with-6:IN Spark-7:NN ,-8:, we-9:PRP made-10:VBD two-11:CD changes-12:NNS :-13:: 1-14:CD .-15:. We-1:PRP made-2:VBD the-3:DT interpreter-4:NN output-5:NN the-6:DT classes-7:NNS it-8:PRP defines-9:VBZ to-1:TO a-2:DT shared-3:JJ filesystem-4:NN ,-5:, from-6:IN which-7:WDT they-8:PRP can-9:MD be-10:VB loaded-11:VBN by-12:IN the-13:DT workers-14:NNS using-15:VBG a-16:DT custom-17:NN Java-18:NNP class-19:NN loader-20:NN .-21:. 2-1:LS .-2:. We-1:PRP changed-2:VBD the-3:DT generated-4:VBN code-5:NN so-6:IN that-7:IN the-8:DT singleton-9:NN object-10:NN for-11:IN each-12:DT line-13:NN references-14:NNS the-15:DT singleton-16:NN objects-17:NNS for-18:IN previous-19:JJ lines-20:NNS directly-21:RB ,-22:, rather-23:RB than-24:IN going-25:VBG through-26:IN the-27:DT static-28:JJ getInstance-29:NN methods-30:NNS .-31:. This-1:DT allows-2:VBZ closures-3:NNS to-4:TO capture-5:VB the-6:DT current-7:JJ state-8:NN of-9:IN the-10:DT singletons-11:NNS they-12:PRP reference-13:VBP whenever-14:WRB they-15:PRP are-16:VBP serialized-17:VBN to-18:TO be-19:VB sent-20:VBN to-21:TO a-22:DT worker-23:NN .-24:. If-1:IN we-2:PRP had-3:VBD not-4:RB done-5:VBN this-6:DT ,-7:, then-8:RB updates-9:NNS to-10:TO the-11:DT singleton-12:NN objects-13:NNS -LRB--14:-LRB- e.g.-15:FW ,-16:, a-17:DT line-18:NN setting-19:NN x-20:NN =-21:JJ 7-22:CD in-23:IN the-24:DT example-25:NN above-26:IN -RRB--27:-RRB- would-28:MD not-29:RB propagate-30:VB to-31:TO the-32:DT workers-33:NNS .-34:. 5-1:CD Results-2:NNS Although-3:IN our-4:PRP$ implementation-5:NN of-6:IN Spark-7:NNP is-8:VBZ still-9:RB at-10:IN an-11:DT early-12:JJ stage-13:NN ,-14:, we-15:PRP relate-16:VBP the-17:DT results-18:NNS of-19:IN three-20:CD experiments-21:NNS that-22:WDT show-23:VBP its-24:PRP$ promise-25:NN as-26:IN a-27:DT cluster-28:NN computing-29:NN framework-30:NN .-31:. Logistic-1:NNP Regression-2:NN :-3:: We-4:PRP compared-5:VBD the-6:DT performance-7:NN of-8:IN the-9:DT logistic-10:JJ regression-11:NN job-12:NN in-13:IN Section-14:NN 3.2-15:CD to-16:TO an-17:DT implementation-18:NN of-19:IN logistic-20:JJ regression-21:NN for-22:IN Hadoop-23:NNP ,-24:, using-25:VBG a-26:DT 29-27:CD GB-28:NN dataset-29:NN on-30:IN 20-31:CD ``-32:`` m1.xlarge-33:NN ''-34:'' EC2-35:NN nodes-36:NNS with-37:IN 4-38:CD cores-39:NNS each-40:DT .-41:. The-1:DT results-2:NNS are-3:VBP shown-4:VBN in-5:IN Figure-6:NN 2-7:CD .-8:. With-1:IN Hadoop-2:NNP ,-3:, each-4:DT iteration-5:NN takes-6:VBZ 127s-7:NNS ,-8:, because-9:IN it-10:PRP runs-11:VBZ as-12:IN an-13:DT independent-14:JJ MapReduce-15:NNP job-16:NN .-17:. With-1:IN Spark-2:NN ,-3:, the-4:DT first-5:JJ iteration-6:NN takes-7:VBZ 174s-8:NNS -LRB--9:-LRB- likely-10:RB due-11:JJ to-12:TO using-13:VBG Scala-14:NNP instead-15:RB of-16:IN Java-17:NNP -RRB--18:-RRB- ,-19:, but-20:CC subsequent-21:JJ 0-1:CD 1000 2000 3000 4000-2:CD 1-3:CD 5-4:CD 10-5:CD 20-6:CD 30-7:CD R-8:NN un-9:NN ni-10:NNS ng-11:NN T-12:NN im-13:NN e-14:SYM -LRB--15:-LRB- s-16:NNS -RRB--17:-RRB- Number-18:NNP of-19:IN Iterations-20:NNPS Hadoop-21:NNP Spark-22:NNP Figure-1:NN 2-2:CD :-3:: Logistic-4:JJ regression-5:NN performance-6:NN in-7:IN Hadoop-8:NNP and-9:CC Spark-10:NNP .-11:. iterations-1:NNS take-2:VBP only-3:RB 6s-4:RB ,-5:, each-6:DT because-7:IN they-8:PRP reuse-9:VBP cached-10:VBN data-11:NNS .-12:. This-1:DT allows-2:VBZ the-3:DT job-4:NN to-5:TO run-6:VB up-7:RP to-8:TO 10x-9:VB faster-10:RBR .-11:. We-1:PRP have-2:VBP also-3:RB tried-4:VBN crashing-5:VBG a-6:DT node-7:NN while-8:IN the-9:DT job-10:NN was-11:VBD running-1:VBG .-2:. In-1:IN the-2:DT 10-iteration-3:JJ case-4:NN ,-5:, this-6:DT slows-7:VBZ the-8:DT job-9:NN down-10:RP by-11:IN 50s-12:CD -LRB--13:-LRB- 21-14:CD %-15:NN -RRB--16:-RRB- on-17:IN average-18:NN .-19:. The-1:DT data-2:NNS partitions-3:NNS on-4:IN the-5:DT lost-6:VBN node-7:NN are-8:VBP recomputed-9:VBN and-10:CC cached-11:VBN in-12:IN parallel-13:NN on-14:IN other-15:JJ nodes-16:NNS ,-17:, but-18:CC the-19:DT recovery-20:NN time-21:NN was-22:VBD rather-23:RB high-24:JJ in-25:IN the-26:DT current-27:JJ experiment-28:NN because-29:IN we-30:PRP used-31:VBD a-32:DT high-33:JJ HDFS-34:NN block-35:NN size-36:NN -LRB--37:-LRB- 128-38:CD MB-39:NN -RRB--40:-RRB- ,-41:, so-42:RB there-43:EX were-44:VBD only-45:RB 12-46:CD blocks-47:NNS per-48:IN node-49:NN and-50:CC the-51:DT recovery-52:NN process-53:NN could-54:MD not-55:RB utilize-56:VB all-57:DT cores-58:NNS in-59:IN the-60:DT cluster-61:NN .-62:. Smaller-1:JJR block-2:NN sizes-3:NNS would-4:MD yield-5:VB faster-6:RBR recovery-7:NN times-8:NNS .-9:. Alternating-1:VBG Least-2:NNP Squares-3:NNPS :-4:: We-5:PRP have-6:VBP implemented-7:VBN the-8:DT alternating-9:VBG least-10:JJS squares-11:NNS job-12:NN in-13:IN Section-14:NN 3.3-15:CD to-16:TO measure-17:VB the-18:DT benefit-19:NN of-20:IN broadcast-21:NN variables-22:NNS for-23:IN iterative-24:JJ jobs-25:NNS that-26:WDT copy-27:VBP a-28:DT shared-29:JJ dataset-30:NN to-31:TO multiple-32:JJ nodes-33:NNS .-34:. We-1:PRP found-2:VBD that-3:IN without-4:IN using-5:VBG broadcast-6:NN variables-7:NNS ,-8:, the-9:DT time-10:NN to-11:TO resend-12:VB the-13:DT ratings-14:NNS matrix-15:NN R-16:NN on-17:IN each-18:DT iteration-19:NN dominated-20:VBD the-21:DT job-22:NN 's-23:POS running-24:VBG time-25:NN .-26:. Furthermore-1:RB ,-2:, with-3:IN a-4:DT naı̈ve-5:JJ implementation-6:NN of-7:IN broadcast-8:NN -LRB--9:-LRB- using-10:VBG HDFS-11:NN or-12:CC NFS-13:NN -RRB--14:-RRB- ,-15:, the-16:DT broadcast-17:NN time-18:NN grew-19:VBD linearly-20:RB with-21:IN the-22:DT number-23:NN of-24:IN nodes-25:NNS ,-26:, limiting-27:VBG the-28:DT scalability-29:NN of-30:IN the-31:DT job-32:NN .-33:. We-1:PRP implemented-2:VBD an-3:DT application-level-4:JJ multicast-5:JJ system-6:NN to-7:TO mitigate-8:VB this-9:DT .-10:. However-1:RB ,-2:, even-3:RB with-4:IN fast-5:JJ broadcast-6:NN ,-7:, resending-8:VBG R-9:NN on-10:IN each-11:DT iteration-12:NN is-13:VBZ costly-14:JJ .-15:. Caching-1:VBG R-2:NN in-3:IN memory-4:NN on-5:IN the-6:DT workers-7:NNS using-8:VBG a-9:DT broadcast-10:NN variable-11:JJ improved-12:JJ performance-13:NN by-14:IN 2.8-15:CD x-16:NN in-17:IN an-18:DT experiment-19:NN with-20:IN 5000-21:CD movies-22:NNS and-23:CC 15000-24:CD users-25:NNS on-26:IN a-27:DT 30-node-28:JJ EC2-29:NN cluster-30:NN .-31:. Interactive-1:JJ Spark-2:NNP :-3:: We-4:PRP used-5:VBD the-6:DT Spark-7:NN interpreter-8:NN to-9:TO load-10:VB a-11:DT 39-12:CD GB-13:NN dump-14:NN of-15:IN Wikipedia-16:NNP in-17:IN memory-18:NN across-19:IN 15-20:CD ``-21:`` m1.xlarge-22:NN ''-23:'' EC2-24:NN machines-25:NNS and-26:CC query-27:VB it-28:PRP interactively-29:RB .-30:. The-1:DT first-2:JJ time-3:NN the-4:DT dataset-5:NN is-6:VBZ queried-7:VBN ,-8:, it-9:PRP takes-10:VBZ roughly-11:RB 35-12:CD seconds-13:NNS ,-14:, comparable-15:JJ to-16:TO running-17:VBG a-18:DT Hadoop-19:NNP job-20:NN on-21:IN it-22:PRP .-23:. However-1:RB ,-2:, subsequent-3:JJ queries-4:NNS take-5:VBP only-6:RB 0.5-7:CD to-8:TO 1-9:CD seconds-10:NNS ,-11:, even-12:RB if-13:IN they-14:PRP scan-15:VBP all-16:PDT the-17:DT data-18:NNS .-19:. This-1:DT provides-2:VBZ a-3:DT qualitatively-4:RB different-5:JJ experience-6:NN ,-7:, comparable-8:JJ to-9:TO working-10:VBG with-11:IN local-12:JJ data-13:NNS .-14:. 6-1:CD Related-2:JJ Work-3:NN Distributed-4:VBN Shared-5:NNP Memory-6:NN :-7:: Spark-8:NNP 's-9:POS resilient-10:JJ distributed-11:VBN datasets-12:NNS can-13:MD be-14:VB viewed-15:VBN as-16:IN an-17:DT abstraction-18:NN for-19:IN distributed-20:VBN shared-21:JJ memory-22:NN -LRB--23:-LRB- DSM-24:NNP -RRB--25:-RRB- ,-26:, which-27:WDT has-28:VBZ been-29:VBN studied-30:VBN extensively-31:RB -LSB--32:-LRB- 20-33:CD -RSB--34:-RRB- .-35:. RDDs-1:NNS differ-2:VBP from-3:IN DSM-4:NNP interfaces-5:NNS in-6:IN two-7:CD ways-8:NNS .-9:. First-1:RB ,-2:, RDDs-3:NNS provide-4:VBP a-5:DT much-6:RB more-7:RBR restricted-8:JJ programming-9:NN model-10:NN ,-11:, but-12:CC one-13:CD that-14:WDT lets-15:VBZ datasets-16:NNS be-17:VB rebuilt-18:VBN efficiently-19:RB if-20:IN cluster-21:NN nodes-22:NNS fail-23:VBP .-24:. While-1:IN some-2:DT DSM-3:NNP systems-4:NNS achieve-5:VBP fault-6:NN tolerance-7:NN through-8:IN checkpointing-9:NN -LSB--10:-LRB- 18-11:CD -RSB--12:-RRB- ,-13:, Spark-14:NN reconstructs-15:VBZ lost-16:VBN partitions-17:NNS of-18:IN RDDs-19:NNS using-20:VBG lineage-21:NN information-22:NN captured-23:VBN in-24:IN the-25:DT RDD-26:NN objects-27:NNS .-28:. This-1:DT means-2:VBZ that-3:IN only-4:RB the-5:DT lost-6:VBN partitions-7:NNS need-8:VBP to-9:TO be-10:VB recomputed-11:VBN ,-12:, and-13:CC that-14:IN they-15:PRP can-16:MD be-17:VB recomputed-18:VBN in-19:IN parallel-20:NN on-21:IN different-22:JJ nodes-23:NNS ,-24:, without-25:IN requiring-26:VBG the-27:DT program-28:NN to-29:TO revert-30:VB to-31:TO a-32:DT checkpoint-33:NN .-34:. In-1:IN addition-2:NN ,-3:, there-4:EX is-5:VBZ no-6:DT overhead-7:NN if-8:IN no-9:DT nodes-10:NNS fail-11:VBP .-12:. Second-1:RB ,-2:, RDDs-3:NNS push-4:VBP computation-5:NN to-6:TO the-7:DT data-8:NNS as-9:IN inMapReduce-10:NN -LSB--11:-LRB- 11-12:CD -RSB--13:-RRB- ,-14:, rather-15:RB than-16:IN letting-17:VBG arbitrary-18:JJ nodes-19:NNS access-20:NN a-21:DT global-22:JJ address-23:NN space-24:NN .-25:. Other-1:JJ systems-2:NNS have-3:VBP also-4:RB restricted-5:VBN the-6:DT DSM-7:NNP program-8:NN --9:: ming-1:VBG model-2:NN to-3:TO improve-4:VB performance-5:NN ,-6:, reliability-7:NN and-8:CC programmability-9:NN .-10:. Munin-1:NN -LSB--2:-LRB- 8-3:CD -RSB--4:-RRB- lets-5:VBZ programmers-6:NNS annotate-7:VBP variables-8:NNS with-9:IN the-10:DT access-11:NN pattern-12:NN they-13:PRP will-14:MD have-15:VB so-16:RB as-17:IN to-18:TO choose-19:VB an-20:DT optimal-21:JJ consistency-22:NN protocol-23:NN for-24:IN them-25:PRP .-26:. Linda-1:NNP -LSB--2:-LRB- 13-3:CD -RSB--4:-RRB- provides-5:VBZ a-6:DT tuple-7:JJ space-8:NN programming-9:NN model-10:NN that-11:WDT may-12:MD be-13:VB implemented-14:VBN in-15:IN a-16:DT fault-tolerant-17:JJ fashion-18:NN .-19:. Thor-1:NNP -LSB--2:-LRB- 19-3:CD -RSB--4:-RRB- provides-5:VBZ an-6:DT interface-7:NN to-8:TO persistent-9:JJ shared-10:JJ objects-11:NNS .-12:. Cluster-1:NNP Computing-2:NNP Frameworks-3:NNPS :-4:: Spark-5:NNP 's-6:POS parallel-7:JJ operations-8:NNS fit-9:VBP into-10:IN the-11:DT MapReduce-12:NNP model-13:NN -LSB--14:-LRB- 11-15:CD -RSB--16:-RRB- .-17:. However-1:RB ,-2:, they-3:PRP operate-4:VBP on-5:IN RDDs-6:NNS that-7:WDT can-8:MD persist-9:VB across-10:IN operations-11:NNS .-12:. The-1:DT need-2:NN to-3:TO extendMapReduce-4:NN to-5:TO support-6:VB iterative-7:JJ jobs-8:NNS was-1:VBD also-2:RB recognized-3:VBN by-4:IN Twister-5:NN -LSB--6:-LRB- 6-7:CD ,-8:, 12-9:CD -RSB--10:-RRB- ,-11:, a-12:DT MapReduce-13:NNP framework-14:NN that-15:WDT allows-16:VBZ long-lived-17:JJ map-18:NN tasks-19:NNS to-20:TO keep-21:VB static-22:JJ data-23:NNS in-24:IN memory-25:NN between-26:IN jobs-27:NNS .-28:. However-1:RB ,-2:, Twister-3:NNP does-4:VBZ not-5:RB currently-6:RB implement-7:VB fault-8:NN tolerance-9:NN .-10:. Spark-1:NN 's-2:POS abstraction-3:NN of-4:IN resilient-5:JJ distributed-6:VBN datasets-7:NNS is-8:VBZ both-9:DT fault-tolerant-10:JJ and-11:CC more-12:RBR general-13:JJ than-14:IN iterative-15:JJ MapReduce-16:NNP .-17:. A-1:DT Spark-2:NN program-3:NN can-4:MD define-5:VB multiple-6:JJ RDDs-7:NNS and-8:CC alternate-9:JJ between-10:IN running-11:VBG operations-12:NNS on-13:IN them-14:PRP ,-15:, whereas-16:IN a-17:DT Twister-18:NNP program-19:NN has-20:VBZ only-21:RB one-22:CD map-23:NN function-24:NN and-25:CC one-26:CD reduce-27:VB function-28:NN .-29:. This-1:DT also-2:RB makes-3:VBZ Spark-4:NN useful-5:JJ for-6:IN interactive-7:JJ data-8:NN analysis-9:NN ,-10:, where-11:WRB a-12:DT user-13:NN can-14:MD define-15:VB several-16:JJ datasets-17:NNS and-18:CC then-19:RB query-20:VB them-21:PRP .-22:. Spark-1:NN 's-2:POS broadcast-3:NN variables-4:NNS provide-5:VBP a-6:DT similar-7:JJ facility-8:NN to-9:TO Hadoop-1:NNP 's-2:POS distributed-3:VBN cache-4:NN -LSB--5:-LRB- 2-6:CD -RSB--7:-RRB- ,-8:, which-9:WDT can-10:MD disseminate-11:VB a-12:DT file-13:NN to-14:TO all-15:DT nodes-16:NNS running-17:VBG a-18:DT particular-19:JJ job-20:NN .-21:. However-1:RB ,-2:, broadcast-3:NN variables-4:NNS can-5:MD be-6:VB reused-7:VBN across-8:IN parallel-9:JJ operations-10:NNS .-11:. Language-1:NN Integration-2:NN :-3:: Spark-4:NNP 's-5:POS language-6:NN integration-7:NN is-8:VBZ similar-9:JJ to-10:TO that-11:DT of-12:IN DryadLINQ-13:NN -LSB--14:-LRB- 25-15:CD -RSB--16:-RRB- ,-17:, which-18:WDT uses-19:VBZ .-20:. NET-1:NNP 's-2:POS support-3:NN for-4:IN language-5:NN integrated-6:VBN queries-7:NNS to-8:TO capture-9:VB an-10:DT expression-11:NN tree-12:NN defining-13:VBG a-14:DT query-15:NN and-16:CC run-17:VB it-18:PRP on-19:IN a-20:DT cluster-21:NN .-22:. Unlike-1:IN DryadLINQ-2:NN ,-3:, Spark-4:NN allows-5:VBZ RDDs-6:NNS to-7:TO persist-8:VB in-9:IN memory-10:NN across-11:IN parallel-12:JJ operations-13:NNS .-14:. In-1:IN addition-2:NN ,-3:, Spark-4:NN enriches-5:VBZ the-6:DT language-7:NN integration-8:NN model-9:NN by-10:IN supporting-11:VBG shared-12:JJ variables-13:NNS -LRB--14:-LRB- broadcast-15:NN variables-16:NNS and-17:CC accumulators-18:NNS -RRB--19:-RRB- ,-20:, implemented-21:VBN using-22:VBG classes-23:NNS with-24:IN custom-25:NN serialized-26:VBD forms-27:NNS .-28:. We-1:PRP were-2:VBD inspired-3:VBN to-4:TO use-5:VB Scala-6:NNP for-7:IN language-8:NN integration-9:NN by-1:IN SMR-2:NN -LSB--3:-LRB- 14-4:CD -RSB--5:-RRB- ,-6:, a-7:DT Scala-8:NNP interface-9:NN for-10:IN Hadoop-11:NNP that-12:WDT uses-13:VBZ closures-14:NNS to-15:TO define-16:VB map-17:NN and-18:CC reduce-19:VB tasks-20:NNS .-21:. Our-1:PRP$ contributions-2:NNS over-3:IN SMR-4:NN are-5:VBP shared-6:VBN variables-7:NNS and-8:CC a-9:DT more-10:RBR robust-11:JJ implementation-12:NN of-13:IN closure-14:NN serialization-15:NN -LRB--16:-LRB- described-17:VBN in-18:IN Section-19:NN 4-20:CD -RRB--21:-RRB- .-22:. Finally-1:RB ,-2:, IPython-3:NN -LSB--4:-LRB- 22-5:CD -RSB--6:-RRB- is-7:VBZ a-8:DT Python-9:JJ interpreter-10:NN for-11:IN scien-12:NN --13:: tists-14:NNS that-15:WDT lets-16:VBZ users-17:NNS launch-18:VB computations-19:NNS on-20:IN a-21:DT cluster-22:NN using-23:VBG a-24:DT fault-tolerant-25:JJ task-26:NN queue-27:NN interface-28:NN or-29:CC low-level-30:JJ message-31:NN passing-32:VBG interface-33:NN .-34:. Spark-1:VB provides-2:VBZ a-3:DT similar-4:JJ interactive-5:JJ interface-6:NN ,-7:, but-8:CC focuses-9:VBZ on-10:IN data-intensive-11:JJ computations-12:NNS .-13:. Lineage-1:NN :-2:: Capturing-3:VBG lineage-4:NN or-5:CC provenance-6:NN information-7:NN for-8:IN datasets-9:NNS has-10:VBZ long-11:RB been-12:VBN a-13:DT research-14:NN topic-15:NN in-16:IN the-17:DT scientific-18:JJ computing-19:VBG an-20:DT database-21:NN fields-22:NNS ,-23:, for-24:IN applications-25:NNS such-26:JJ as-27:IN explaining-28:VBG results-29:NNS ,-30:, allowing-31:VBG them-32:PRP to-33:TO be-34:VB reproduced-35:VBN by-36:IN others-37:NNS ,-38:, and-39:CC recomputing-40:VBG data-41:NNS if-42:IN a-43:DT bug-44:NN is-45:VBZ found-46:VBN in-47:IN a-48:DT work-flow-49:NN step-50:NN or-51:CC if-52:IN a-53:DT dataset-54:NN is-55:VBZ lost-56:VBN .-57:. We-1:PRP refer-2:VBP the-3:DT reader-4:NN to-5:TO -LSB--6:-LRB- 7-7:CD -RSB--8:-RRB- ,-9:, -LSB--10:-LRB- 23-11:CD -RSB--12:-RRB- and-13:CC -LSB--14:-LRB- 9-15:CD -RSB--16:-RRB- for-17:IN surveys-18:NNS of-19:IN this-20:DT work-21:NN .-22:. Spark-1:VB provides-2:VBZ a-3:DT restricted-4:JJ parallel-5:JJ programming-6:NN model-7:NN where-8:WRB fine-grained-9:JJ lineage-10:NN is-11:VBZ inexpensive-12:JJ to-13:TO capture-14:VB ,-15:, so-16:RB that-17:IN this-18:DT information-19:NN can-20:MD be-21:VB used-22:VBN to-23:TO recompute-24:VB lost-25:VBN dataset-26:JJ elements-27:NNS .-28:. 7-1:CD Discussion-2:NN and-3:CC Future-4:JJ Work-5:NN Spark-6:NN provides-7:VBZ three-8:CD simple-9:JJ data-10:NNS abstractions-11:NNS for-12:IN programming-13:NN clusters-14:NNS :-15:: resilient-16:JJ distributed-17:VBN datasets-18:NNS -LRB--19:-LRB- RDDs-20:NNS -RRB--21:-RRB- ,-22:, and-23:CC two-24:CD restricted-25:JJ types-26:NNS of-27:IN shared-28:JJ variables-29:NNS :-30:: broadcast-31:NN variables-32:NNS and-33:CC accumulators-34:NNS .-35:. While-1:IN these-2:DT abstractions-3:NNS are-4:VBP limited-5:VBN ,-6:, we-7:PRP have-8:VBP found-9:VBN that-10:IN they-11:PRP are-12:VBP powerful-13:JJ enough-14:JJ to-15:TO express-16:VB several-17:JJ applications-18:NNS that-19:WDT pose-20:VBP challenges-21:NNS for-22:IN existing-23:VBG cluster-24:NN computing-25:NN frameworks-26:NNS ,-27:, including-28:VBG iterative-29:JJ and-30:CC interactive-31:JJ computations-32:NNS .-33:. Furthermore-1:RB ,-2:, we-3:PRP believe-4:VBP that-5:IN the-6:DT core-7:NN idea-8:NN behind-9:IN RDDs-10:NNS ,-11:, of-12:IN a-13:DT dataset-14:NN handle-15:VB that-16:DT has-17:VBZ enough-18:RB information-19:NN to-20:TO -LRB--21:-LRB- re-22:NN -RRB--23:-RRB- construct-24:NN the-25:DT dataset-26:NN from-27:IN data-28:NNS available-29:JJ in-30:IN reliable-31:JJ storage-32:NN ,-33:, may-34:MD prove-35:VB useful-36:JJ in-37:IN developing-38:VBG other-39:JJ abstractions-40:NNS for-41:IN programming-42:NN clusters-43:NNS .-44:. In-1:IN future-2:JJ work-3:NN ,-4:, we-5:PRP plan-6:VBP to-7:TO focus-8:VB on-9:IN four-10:CD areas-11:NNS :-12:: 1-1:LS .-2:. Formally-1:RB characterize-2:VBP the-3:DT properties-4:NNS of-5:IN RDDs-6:NNS and-7:CC Spark-8:NN 's-9:POS other-10:JJ abstractions-11:NNS ,-12:, and-13:CC their-14:PRP$ suitability-15:NN for-16:IN various-17:JJ classes-18:NNS of-19:IN applications-20:NNS and-21:CC workloads-22:NNS .-23:. 2-1:LS .-2:. Enhance-1:VB the-2:DT RDD-3:NN abstraction-4:NN to-5:TO allow-6:VB programmers-7:NNS to-8:TO trade-9:VB between-10:IN storage-11:NN cost-12:NN and-13:CC re-construction-14:NN cost-15:NN .-16:. 3-1:LS .-2:. Define-1:VB new-2:JJ operations-3:NNS to-4:TO transform-5:VB RDDs-6:NNS ,-7:, including-8:VBG a-9:DT ``-10:`` shuffle-11:NN ''-12:'' operation-13:NN that-14:WDT repartitions-15:VBZ an-16:DT RDD-17:NN by-18:IN a-19:DT given-20:VBN key-21:NN .-22:. Such-1:PDT an-2:DT operation-3:NN would-4:MD allow-5:VB us-6:PRP to-7:TO implement-8:VB group-bys-9:NNS and-10:CC joins-11:VBZ .-12:. 4-1:LS .-2:. Provide-1:VB higher-level-2:JJ interactive-3:JJ interfaces-4:NNS on-5:IN top-6:NN of-7:IN the-8:DT Spark-9:NN interpreter-10:NN ,-11:, such-12:JJ as-13:IN SQL-14:NN and-15:CC R-16:NN -LSB--17:-LRB- 4-18:CD -RSB--19:-RRB- shells-20:NNS .-21:. 8-1:CD Acknowledgements-2:NNS We-3:PRP thank-4:VBP Ali-5:NNP Ghodsi-6:NNP for-7:IN his-8:PRP$ feedback-9:NN on-10:IN this-11:DT paper-12:NN .-13:. This-1:DT research-2:NN was-3:VBD supported-4:VBN by-5:IN California-6:NNP MICRO-7:NNP ,-8:, Califor-nia-9:JJ Discovery-10:NNP ,-11:, the-12:DT Natural-13:NNP Sciences-14:NNPS and-15:CC Engineering-16:NNP Research-17:NNP Council-18:NNP of-19:IN Canada-20:NNP ,-21:, as-22:RB well-23:RB as-24:IN the-25:DT following-26:VBG Berke-ley-27:NN RAD-28:NN Lab-29:NN sponsors-30:NNS :-31:: Sun-32:NNP Microsystems-33:NNPS ,-34:, Google-35:NNP ,-36:, Mi-crosoft-37:NN ,-38:, Amazon-39:NNP ,-40:, Cisco-41:NNP ,-42:, Cloudera-43:NNP ,-44:, eBay-45:NNP ,-46:, Facebook-47:NNP ,-48:, Fu-jitsu-49:NN ,-50:, HP-51:NNP ,-52:, Intel-53:NNP ,-54:, NetApp-55:NNP ,-56:, SAP-57:NN ,-58:, VMware-59:NNP ,-60:, and-61:CC Yahoo!-62:NN .-63:. References-1:NNS -LSB--2:-LRB- 1-3:CD -RSB--4:-RRB- Apache-5:NNP Hive-6:NNP .-7:. http://hadoop.apache.org/hive-1:NN .-2:. -LSB--1:-LRB- 2-2:CD -RSB--3:-RRB- Hadoop-4:NNP Map/Reduce-5:NNP tutorial-6:NN .-7:. http://hadoop.apache.org/-1:NN common/docs/r0-2:NN .20.0-3:CD /-4:: mapred-5:JJ tutorial.html-6:NN .-7:. -LSB--1:-LRB- 3-2:CD -RSB--3:-RRB- Logistic-4:NNP regression-5:NN --6:: Wikipedia-7:NNP .-8:. http://en.wikipedia.org/wiki/Logistic-1:JJ regression-2:NN .-3:. -LSB--1:-LRB- 4-2:LS -RSB--3:-RRB- The-4:DT R-5:NN project-6:NN for-7:IN statistical-8:JJ computing-9:NN .-10:. http://www.r-project.org-1:NN .-2:. -LSB--1:-LRB- 5-2:CD -RSB--3:-RRB- Scala-4:NNP programming-5:NN language-6:NN .-7:. http://www.scala-lang.org-1:NN .-2:. -LSB--1:-LRB- 6-2:CD -RSB--3:-RRB- Twister-4:NNP :-5:: Iterative-6:JJ MapReduce-7:NN .-8:. http://iterativemapreduce.org-1:NN .-2:. -LSB--1:-LRB- 7-2:CD -RSB--3:-RRB- R.-4:NNP Bose-5:NNP and-6:CC J.-7:NNP Frew-8:NNP .-9:. Lineage-1:NN retrieval-2:NN for-3:IN scientific-4:JJ data-5:NNS processing-1:NN :-2:: a-3:DT survey-4:NN .-5:. ACM-1:NNP Computing-2:NNP Surveys-3:NNS ,-4:, 37:1-5:CD -28-6:CD ,-7:, 2005-8:CD .-9:. -LSB--1:-LRB- 8-2:CD -RSB--3:-RRB- J.-4:NNP B.-5:NNP Carter-6:NNP ,-7:, J.-8:NNP K.-9:NNP Bennett-10:NNP ,-11:, and-12:CC W.-13:NNP Zwaenepoel-14:NNP .-15:. Implementation-1:NN and-2:CC performance-3:NN of-4:IN Munin-5:NN .-6:. In-1:IN SOSP-2:NN '-3:'' 91-4:CD .-5:. ACM-1:NNP ,-2:, 1991-3:CD .-4:. -LSB--1:-LRB- 9-2:CD -RSB--3:-RRB- J.-4:NNP Cheney-5:NNP ,-6:, L.-7:NNP Chiticariu-8:NNP ,-9:, and-10:CC W.-C-11:NN .-12:. Tan-1:NNP .-2:. Provenance-1:NNP in-2:IN databases-3:NNS :-4:: Why-5:WRB ,-6:, how-7:WRB ,-8:, and-9:CC where-10:WRB .-11:. Foundations-1:NNS and-2:CC Trends-3:NNS in-4:IN Databases-5:NNS ,-6:, 1-7:CD -LRB--8:-LRB- 4-9:CD -RRB--10:-RRB- :379-11:CD -474-12:CD ,-13:, 2009-14:CD .-15:. -LSB--1:-LRB- 10-2:CD -RSB--3:-RRB- C.-4:NNP T.-5:NNP Chu-6:NNP ,-7:, S.-8:NNP K.-9:NNP Kim-10:NNP ,-11:, Y.-12:NNP A.-13:NNP Lin-14:NNP ,-15:, Y.-16:NNP Yu-17:NNP ,-18:, G.-19:NNP R.-20:NNP Bradski-21:NNP ,-22:, A.-23:NNP Y.-24:NNP Ng-25:NNP ,-26:, and-27:CC K.-28:NNP Olukotun-29:NNP .-30:. Map-reduce-1:NN for-2:IN machine-3:NN learning-4:NN on-5:IN multicore-6:NN .-7:. In-1:IN NIPS-2:NNS '-3:POS 06-4:CD ,-5:, pages-6:NNS 281-288-7:CD .-8:. MIT-1:NNP Press-2:NNP ,-3:, 2006-4:CD .-5:. -LSB--1:-LRB- 11-2:CD -RSB--3:-RRB- J.-4:NNP Dean-5:NNP and-6:CC S.-7:NNP Ghemawat-8:NNP .-9:. MapReduce-1:NNP :-2:: Simplified-3:VBN data-4:NNS processing-5:NN on-6:IN large-7:JJ clusters-8:NNS .-9:. Commun-1:NNP .-2:. ACM-1:NNP ,-2:, 51-3:CD -LRB--4:-LRB- 1-5:CD -RRB--6:-RRB- :107-7:CD -113-8:CD ,-9:, 2008-10:CD .-11:. -LSB--1:-LRB- 12-2:CD -RSB--3:-RRB- J.-4:NNP Ekanayake-5:NNP ,-6:, S.-7:NNP Pallickara-8:NNP ,-9:, and-10:CC G.-11:NNP Fox-12:NNP .-13:. MapReduce-1:NNP for-2:IN data-3:NNS intensive-4:JJ scientific-5:JJ analyses-6:NNS .-7:. In-1:IN ESCIENCE-2:NN '-3:'' 08-4:CD ,-5:, pages-6:NNS 277-284-7:CD ,-8:, Washington-9:NNP ,-10:, DC-11:NNP ,-12:, USA-13:NNP ,-14:, 2008-15:CD .-16:. IEEE-1:NNP Computer-2:NNP Society-3:NNP .-4:. -LSB--1:-LRB- 13-2:CD -RSB--3:-RRB- D.-4:NNP Gelernter-5:NNP .-6:. Generative-1:JJ communication-2:NN in-3:IN linda-4:NN .-5:. ACM-1:NNP Trans-2:NNP .-3:. Program-1:NN .-2:. Lang-1:NNP .-2:. Syst.-1:NNP ,-2:, 7-3:CD -LRB--4:-LRB- 1-5:CD -RRB--6:-RRB- :80-7:CD -112-8:CD ,-9:, 1985-10:CD .-11:. -LSB--1:-LRB- 14-2:CD -RSB--3:-RRB- D.-4:NNP Hall-5:NNP .-6:. A-1:DT scalable-2:JJ language-3:NN ,-4:, and-5:CC a-6:DT scalable-7:JJ framework-8:NN .-9:. http://www.scala-blogs.org/2008/09/scalable-language-and-scalable.html-1:NN .-2:. -LSB--1:-LRB- 15-2:CD -RSB--3:-RRB- B.-4:NNP Hindman-5:NNP ,-6:, A.-7:NNP Konwinski-8:NNP ,-9:, M.-10:NNP Zaharia-11:NNP ,-12:, A.-13:NNP Ghodsi-14:NNP ,-15:, A.-16:NNP D.-17:NNP Joseph-18:NNP ,-19:, R.-20:NNP H.-21:NNP Katz-22:NNP ,-23:, S.-24:NNP Shenker-25:NNP ,-26:, and-27:CC I.-28:NN Stoica-29:NNP .-30:. Mesos-1:NNP :-2:: A-3:NNP platform-4:NN for-5:IN fine-grained-6:JJ resource-7:NN sharing-8:NN in-9:IN the-10:DT data-11:NNS center-12:NN .-13:. Technical-1:NNP Report-2:NNP UCB/EECS-3:NN -2010-4:CD -87-5:CD ,-6:, EECS-7:NNP Department-8:NNP ,-9:, University-10:NNP of-11:IN California-12:NNP ,-13:, Berkeley-14:NNP ,-15:, May-16:NNP 2010-17:CD .-18:. -LSB--1:-LRB- 16-2:CD -RSB--3:-RRB- B.-4:NNP Hindman-5:NNP ,-6:, A.-7:NNP Konwinski-8:NNP ,-9:, M.-10:NNP Zaharia-11:NNP ,-12:, and-13:CC I.-14:NN Stoica-15:NNP .-16:. A-1:DT common-2:JJ substrate-3:NN for-4:IN cluster-5:NN computing-6:NN .-7:. InWorkshop-1:NNP on-2:IN Hot-3:NNP Topics-4:NNPS in-5:IN Cloud-6:NNP Computing-7:NNP -LRB--8:-LRB- HotCloud-9:NNP -RRB--10:-RRB- 2009-11:CD ,-12:, 2009-13:CD .-14:. -LSB--1:-LRB- 17-2:CD -RSB--3:-RRB- M.-4:NNP Isard-5:NNP ,-6:, M.-7:NNP Budiu-8:NNP ,-9:, Y.-10:NNP Yu-11:NNP ,-12:, A.-13:NNP Birrell-14:NNP ,-15:, and-16:CC D.-17:NNP Fetterly-18:NNP .-19:. Dryad-1:NNP :-2:: Distributed-3:VBN data-parallel-4:JJ programs-5:NNS from-6:IN sequential-7:JJ building-8:NN blocks-9:NNS .-10:. In-1:IN EuroSys-2:NNP 2007-3:CD ,-4:, pages-5:NNS 59-72-6:CD ,-7:, 2007-8:CD .-9:. -LSB--1:-LRB- 18-2:CD -RSB--3:-RRB- A.-M-4:NNP .-5:. Kermarrec-1:NNP ,-2:, G.-3:NNP Cabillic-4:NNP ,-5:, A.-6:NNP Gefflaut-7:NNP ,-8:, C.-9:NNP Morin-10:NNP ,-11:, and-12:CC I.-13:NN Puaut-14:NN .-15:. A-1:DT recoverable-2:JJ distributed-3:VBN shared-4:VBN memory-5:NN integrating-6:VBG coherence-7:NN and-8:CC recoverability-9:NN .-10:. In-1:IN FTCS-2:NN '-3:'' 95-4:CD .-5:. IEEE-1:NNP Computer-2:NNP Society-3:NNP ,-4:, 1995-5:CD .-6:. -LSB--1:-LRB- 19-2:CD -RSB--3:-RRB- B.-4:NNP Liskov-5:NNP ,-6:, A.-7:NNP Adya-8:NNP ,-9:, M.-10:NNP Castro-11:NNP ,-12:, S.-13:NNP Ghemawat-14:NNP ,-15:, R.-16:NNP Gruber-17:NNP ,-18:, U.-19:NNP Maheshwari-20:NNP ,-21:, A.-22:NNP C.-23:NNP Myers-24:NNP ,-25:, M.-26:NNP Day-27:NNP ,-28:, and-29:CC L.-30:NNP Shrira-31:NNP .-32:. Safe-1:NN and-2:CC efficient-3:JJ sharing-4:NN of-5:IN persistent-6:JJ objects-7:NNS in-8:IN thor-9:NN .-10:. In-1:IN SIGMOD-2:NN '-3:'' 96-4:CD ,-5:, pages-6:NNS 318-329-7:CD .-8:. ACM-1:NNP ,-2:, 1996-3:CD .-4:. -LSB--1:-LRB- 20-2:CD -RSB--3:-RRB- B.-4:NNP Nitzberg-5:NNP and-6:CC V.-7:NNP Lo-8:NNP .-9:. Distributed-1:VBN shared-2:JJ memory-3:NN :-4:: a-5:DT survey-6:NN of-7:IN issues-8:NNS and-9:CC algorithms-10:NNS .-11:. Computer-1:NN ,-2:, 24-3:CD -LRB--4:-LRB- 8-5:CD -RRB--6:-RRB- :52-7:CD -60-8:CD ,-9:, aug-10:IN 1991-11:CD .-12:. -LSB--1:-LRB- 21-2:CD -RSB--3:-RRB- C.-4:NNP Olston-5:NNP ,-6:, B.-7:NNP Reed-8:NNP ,-9:, U.-10:NNP Srivastava-11:NNP ,-12:, R.-13:NNP Kumar-14:NNP ,-15:, and-16:CC A.-17:NN Tomkins-18:NNP .-19:. Pig-1:NN latin-2:NN :-3:: a-4:DT not-so-foreign-5:JJ language-6:NN for-7:IN data-8:NNS processing-9:NN .-10:. In-1:IN SIGMOD-2:NN '-3:'' 08-4:CD .-5:. ACM-1:NNP ,-2:, 2008-3:CD .-4:. -LSB--1:-LRB- 22-2:CD -RSB--3:-RRB- F.-4:NNP Pérez-5:NNP and-6:CC B.-7:NNP E.-8:NNP Granger-9:NNP .-10:. IPython-1:NNP :-2:: a-3:DT system-4:NN for-5:IN interactive-1:JJ scientific-2:JJ computing-3:NN .-4:. Comput-1:NNP .-2:. Sci-1:NNP .-2:. Eng.-1:NNP ,-2:, 9-3:CD -LRB--4:-LRB- 3-5:CD -RRB--6:-RRB- :21-7:CD -29-8:CD ,-9:, May-10:NNP 2007-11:CD .-12:. -LSB--1:-LRB- 23-2:CD -RSB--3:-RRB- Y.-4:NNP L.-5:NNP Simmhan-6:NNP ,-7:, B.-8:NNP Plale-9:NNP ,-10:, and-11:CC D.-12:NNP Gannon-13:NNP .-14:. A-1:DT survey-2:NN of-3:IN data-4:NNS provenance-5:NN in-6:IN e-science-7:NN .-8:. SIGMOD-1:NNP Rec.-2:NNP ,-3:, 34-4:CD -LRB--5:-LRB- 3-6:CD -RRB--7:-RRB- :31-8:CD -36-9:CD ,-10:, 2005-11:CD .-12:. -LSB--1:-LRB- 24-2:CD -RSB--3:-RRB- H.-c-4:NN .-5:. Yang-1:NNP ,-2:, A.-3:NNP Dasdan-4:NNP ,-5:, R.-L-6:NN .-7:. Hsiao-1:NNP ,-2:, and-3:CC D.-4:NNP S.-5:NNP Parker-6:NNP .-7:. Map-reduce-merge-1:NN :-2:: simplified-3:VBN relational-4:JJ data-5:NNS processing-6:NN on-7:IN large-8:JJ clusters-9:NNS .-10:. In-1:IN SIGMOD-2:NN '-3:'' 07-4:CD ,-5:, pages-6:NNS 1029-1040-7:CD .-8:. ACM-1:NNP ,-2:, 2007-3:CD .-4:. -LSB--1:-LRB- 25-2:CD -RSB--3:-RRB- Y.-4:NNP Yu-5:NNP ,-6:, M.-7:NNP Isard-8:NNP ,-9:, D.-10:NNP Fetterly-11:NNP ,-12:, M.-13:NNP Budiu-14:NNP ,-15:, Ú-16:NNP .-17:. Erlingsson-1:NNP ,-2:, P.-3:NNP K.-4:NNP Gunda-5:NNP ,-6:, and-7:CC J.-8:NNP Currey-9:NNP .-10:. DryadLINQ-1:NNP :-2:: A-3:NN system-4:NN for-5:IN general-purpose-6:JJ distributed-7:VBN data-parallel-8:NN computing-9:NN using-10:VBG a-11:DT high-level-12:JJ language-13:NN .-14:. In-1:IN OSDI-2:NN '-3:'' 08-4:CD ,-5:, San-6:NNP Diego-7:NNP ,-8:, CA-9:NNP ,-10:, 2008-11:CD .-12:. -LSB--1:-LRB- 26-2:CD -RSB--3:-RRB- M.-4:NNP Zaharia-5:NNP ,-6:, D.-7:NNP Borthakur-8:NNP ,-9:, J.-10:NNP Sen-11:NNP Sarma-12:NNP ,-13:, K.-14:NNP Elmeleegy-15:NNP ,-16:, S.-17:NNP Shenker-18:NNP ,-19:, and-20:CC I.-21:NN Stoica-22:NNP .-23:. Delay-1:VB scheduling-2:NN :-3:: A-4:DT simple-5:JJ technique-6:NN for-7:IN achieving-8:VBG locality-9:NN and-10:CC fairness-11:NN in-12:IN cluster-13:NN scheduling-14:NN .-15:. In-1:IN EuroSys-2:NNP 2010-3:CD ,-4:, April-5:NNP 2010-6:CD .-7:. -LSB--1:-LRB- 27-2:CD -RSB--3:-RRB- Y.-4:NNP Zhou-5:NNP ,-6:, D.-7:NNP Wilkinson-8:NNP ,-9:, R.-10:NNP Schreiber-11:NNP ,-12:, and-13:CC R.-14:NNP Pan-15:NNP .-16:. Large-scale-1:JJ parallel-2:NN collaborative-3:JJ filtering-4:VBG for-5:IN the-6:DT Netflix-7:NNP prize-8:NN .-9:. In-1:IN AAIM-2:NN '-3:'' 08-4:CD ,-5:, pages-6:NNS 337-348-7:CD ,-8:, Berlin-9:NNP ,-10:, Heidelberg-11:NNP ,-12:, 2008-13:CD .-14:. Springer-Verlag-1:NNP .-2:. 